
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-12T10:21:45.244082 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-12T10:21:45.244082",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": []
  },
  "summary": {
    "total_poses": 10,
    "best_score": -2.947008428337546,
    "worst_score": -1.8414895056677112,
    "mean_score": -2.2432731389575187,
    "score_range": 1.105518922669835,
    "best_energy": -9.306036942778537,
    "worst_energy": -5.117627114994381,
    "mean_energy": -6.709344464316027,
    "energy_range": 4.188409827784156,
    "best_binding_affinity": -10.82722700965323,
    "mean_binding_affinity": -7.860094944213496,
    "best_ic50": 11.55504614643794,
    "mean_ic50": 8991.597710360333
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_23",
      "score": -2.947008428337546,
      "energy": -6.158045241964486,
      "binding_affinity": -10.82722700965323,
      "ic50": 11.55504614643794,
      "ic50_nm": 11.55504614643794,
      "ligand_efficiency": -0.8328636161271715,
      "rmsd": null,
      "confidence": 0.8515123987845898,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2780908933046396,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3034076378220905,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.021765792351843,
          -19.240420459344826,
          7.580665130041927
        ],
        [
          -16.03482277955993,
          -18.09023448361764,
          7.990565292675868
        ],
        [
          -14.790050547152063,
          -18.470377543743254,
          8.393609333118834
        ],
        [
          -16.38637718217266,
          -16.870074452383815,
          7.931487662927521
        ],
        [
          -13.953189579296938,
          -17.401055328600524,
          8.817593977011864
        ],
        [
          -14.270828862909827,
          -19.86553362461236,
          8.569492256245669
        ],
        [
          -14.358067709477808,
          -16.086870592475066,
          8.85156167338407
        ],
        [
          -15.625549633131007,
          -15.816411393753903,
          8.45178136481238
        ],
        [
          -17.90579743507392,
          -16.461810266715382,
          7.55203323232965
        ],
        [
          -13.460938062361873,
          -20.181251897458427,
          7.235102183542795
        ],
        [
          -13.542117315421027,
          -20.093459842752477,
          9.76507240477612
        ],
        [
          -18.81857650207749,
          -16.065587467810058,
          8.734569170565198
        ],
        [
          -17.93191859901357,
          -15.456912646732246,
          6.466466318568093
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_28",
      "score": -2.7444591563455947,
      "energy": -9.11337442372388,
      "binding_affinity": -10.404470460992984,
      "ic50": 23.587734999428243,
      "ic50_nm": 23.587734999428243,
      "ligand_efficiency": -0.8003438816148449,
      "rmsd": null,
      "confidence": 0.8275034344410668,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27238695666218976,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.31180819124388,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.697143391539418,
          -17.33272135478509,
          6.49206050461294
        ],
        [
          -15.299484164149817,
          -17.53729694245537,
          7.659647257006002
        ],
        [
          -14.73530173820563,
          -18.159227333474426,
          8.79592865889738
        ],
        [
          -16.740048349167868,
          -17.254729857019917,
          7.6874946868764455
        ],
        [
          -15.551890228262605,
          -18.42398413297542,
          9.920978587434988
        ],
        [
          -13.244287086196813,
          -18.431043095607308,
          8.822495119992464
        ],
        [
          -16.87898762670715,
          -18.150988581845983,
          9.976955330526645
        ],
        [
          -17.48560242250115,
          -17.66605835023866,
          8.926797949988522
        ],
        [
          -17.46158006086421,
          -16.763700837394087,
          6.471266332744261
        ],
        [
          -12.557497147209352,
          -17.208990329478553,
          9.51311431554409
        ],
        [
          -12.980517530854376,
          -19.754188573399055,
          9.390949520109364
        ],
        [
          -18.266971218225528,
          -17.830397747951757,
          5.785203700109836
        ],
        [
          -18.20068903611608,
          -15.586672863374389,
          6.897108036157053
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_4",
      "score": -2.39575335616387,
      "energy": -6.193562006603109,
      "binding_affinity": -8.575941283744505,
      "ic50": 516.589065875896,
      "ic50_nm": 516.589065875896,
      "ligand_efficiency": -0.6596877910572696,
      "rmsd": null,
      "confidence": 0.6155705303950164,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28880821025891484,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3054022619007464,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.69345538821932,
          -16.356922709058487,
          7.227327747033678
        ],
        [
          -16.037442924049575,
          -17.392679915524248,
          7.866232762467652
        ],
        [
          -14.620403179448944,
          -17.588766857077434,
          7.535489743203062
        ],
        [
          -16.581666435880827,
          -17.872661629285474,
          8.953051426065082
        ],
        [
          -14.064909591772816,
          -18.61579725438164,
          8.201763302585263
        ],
        [
          -14.037923833243255,
          -16.822963181747923,
          6.380841817436961
        ],
        [
          -14.630529366288547,
          -19.2108345327929,
          9.309211928457719
        ],
        [
          -15.971575271153078,
          -18.881744527174817,
          9.622205957383317
        ],
        [
          -18.01501726005334,
          -17.650477319149147,
          9.283585420173758
        ],
        [
          -13.066899804928886,
          -15.755881606367712,
          6.8317509381784465
        ],
        [
          -13.308677690069082,
          -17.851836443580343,
          5.500706797017369
        ],
        [
          -19.00102296169497,
          -18.749488992787327,
          8.829746956626115
        ],
        [
          -18.07047629319734,
          -17.34994503107251,
          10.798085203371567
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_16",
      "score": -2.2712322943409475,
      "energy": -9.306036942778537,
      "binding_affinity": -8.384520604502093,
      "ic50": 713.6281368006452,
      "ic50_nm": 713.6281368006452,
      "ligand_efficiency": -0.6449631234232379,
      "rmsd": null,
      "confidence": 0.7709162951634353,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28109330879138594,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3065843238886594,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.52540324801832,
          -17.090602413538054,
          8.694517517762543
        ],
        [
          -16.26667056297944,
          -17.62945511980099,
          8.289601654755232
        ],
        [
          -15.783114521979464,
          -17.384927617471394,
          7.062647462420921
        ],
        [
          -15.392219172684555,
          -18.186927748678738,
          9.26636296770357
        ],
        [
          -14.491582205321176,
          -17.747360648926982,
          6.718097066676787
        ],
        [
          -16.659023083469958,
          -16.677875506904673,
          5.967764386368594
        ],
        [
          -13.701356410872508,
          -18.385662149080492,
          7.654435021473589
        ],
        [
          -14.128275790333216,
          -18.615648955879333,
          8.864174588866547
        ],
        [
          -15.955188326321709,
          -18.3716856630074,
          10.69874101924566
        ],
        [
          -16.301683088361383,
          -15.215438921155073,
          5.829867910934069
        ],
        [
          -16.60557965984286,
          -17.295291618855575,
          4.677694926712759
        ],
        [
          -16.271503389200532,
          -19.77255358803917,
          10.968997390184622
        ],
        [
          -15.018400540614875,
          -17.726570048662165,
          11.64709808689511
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_5",
      "score": -2.225561408655449,
      "energy": -6.011965335406368,
      "binding_affinity": -7.632443715152115,
      "ic50": 2539.831003294111,
      "ic50_nm": 2539.831003294111,
      "ligand_efficiency": -0.5871110550117011,
      "rmsd": null,
      "confidence": 0.8271943371523565,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2749329004941289,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.308086207150416,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.507146571034973,
          -18.55059285860001,
          8.333295857921005
        ],
        [
          -16.271809487295425,
          -17.94790224897659,
          8.19971808273123
        ],
        [
          -15.839603213334762,
          -16.826959456290393,
          9.167314731952443
        ],
        [
          -15.337221348685663,
          -18.477537045023016,
          7.282030774861588
        ],
        [
          -14.684620524215141,
          -16.280779939797725,
          8.93777992434641
        ],
        [
          -16.774632445631084,
          -16.30556022004938,
          10.070665122325952
        ],
        [
          -13.758343403384785,
          -16.74173146054527,
          7.997437441224971
        ],
        [
          -14.11237851304519,
          -17.81116443788988,
          7.11722147410732
        ],
        [
          -15.815276894101626,
          -19.60029741437127,
          6.410623821924885
        ],
        [
          -16.481146123004297,
          -16.859226247014757,
          11.52337952316899
        ],
        [
          -16.97578982144261,
          -14.861245163699568,
          9.96451244370258
        ],
        [
          -15.976434625968672,
          -19.160356308629638,
          4.997401279017494
        ],
        [
          -14.565597028855766,
          -20.67664719911249,
          6.338619522715143
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_24",
      "score": -2.0405947610301567,
      "energy": -5.589953316076203,
      "binding_affinity": -6.700221784475179,
      "ic50": 12251.760012716764,
      "ic50_nm": 12251.760012716764,
      "ligand_efficiency": -0.51540167572886,
      "rmsd": null,
      "confidence": 0.8911222193209074,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28136623030034746,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.303796611187093,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.345453961403393,
          -19.556990964190902,
          7.49517793631523
        ],
        [
          -15.508363906505954,
          -18.250898507688476,
          8.013067723223411
        ],
        [
          -14.971652728272046,
          -17.15472112070278,
          7.430891437096396
        ],
        [
          -16.456283984120397,
          -18.0841244448727,
          8.951079117721115
        ],
        [
          -15.216469071492975,
          -15.960165472444448,
          7.907185468483774
        ],
        [
          -13.908318599156798,
          -17.3104515572753,
          6.3852864588413425
        ],
        [
          -16.02522368731032,
          -15.584314039934682,
          8.909721883641362
        ],
        [
          -16.768451839510096,
          -16.722196662598343,
          9.442658027055863
        ],
        [
          -17.269817101031343,
          -19.275710247740342,
          9.594637280908534
        ],
        [
          -14.486215711088237,
          -17.105460008234765,
          5.0010792103642085
        ],
        [
          -12.672010753405134,
          -16.517725864485712,
          6.5517975484497555
        ],
        [
          -16.743861277687554,
          -19.621580243956686,
          11.036617545926145
        ],
        [
          -18.727877379015755,
          -18.95566086587483,
          9.620800361972847
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_11",
      "score": -2.0301396884188043,
      "energy": -5.117627114994381,
      "binding_affinity": -6.7022776593221955,
      "ic50": 12209.316713947064,
      "ic50_nm": 12209.316713947064,
      "ligand_efficiency": -0.5155598199478612,
      "rmsd": null,
      "confidence": 0.7338676742881465,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2864870470504617,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.297010467292391,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.592934024693847,
          -18.00767021136147,
          6.458772205265914
        ],
        [
          -15.882753603568052,
          -17.79653895922903,
          7.681242447052107
        ],
        [
          -16.53634677198489,
          -17.02945964499226,
          8.59374869840292
        ],
        [
          -14.89052257173054,
          -18.350745354873347,
          8.040798674745997
        ],
        [
          -15.895757602412395,
          -16.675148285912808,
          9.683982737010254
        ],
        [
          -17.89447523385713,
          -16.253088707172026,
          8.2014976442108
        ],
        [
          -14.70652577791567,
          -17.29474899875967,
          10.13901773100061
        ],
        [
          -14.19699616720424,
          -18.2040298910492,
          9.144854701333955
        ],
        [
          -14.042826767245884,
          -19.408559011601152,
          7.047117953397894
        ],
        [
          -19.093668280311235,
          -16.923347936179468,
          8.887041189969679
        ],
        [
          -17.675133965746852,
          -14.698637021144535,
          8.56398084525826
        ],
        [
          -12.86232088859896,
          -18.717063921007924,
          6.241617522958149
        ],
        [
          -13.829738344730302,
          -20.740962056717063,
          7.656327649393404
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_12",
      "score": -2.00046551758158,
      "energy": -6.453730802208021,
      "binding_affinity": -6.847736633728349,
      "ic50": 9551.206417628673,
      "ic50_nm": 9551.206417628673,
      "ligand_efficiency": -0.5267489718252576,
      "rmsd": null,
      "confidence": 0.6413652626888322,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2972506964539289,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.306164032458749,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.256459638946733,
          -18.879820071432867,
          8.84502613553272
        ],
        [
          -15.224521840536081,
          -17.953459801254795,
          8.40643623146229
        ],
        [
          -15.077641624356112,
          -16.57698880061523,
          8.288957398734883
        ],
        [
          -16.416892636016623,
          -18.568538140138813,
          7.965052537843909
        ],
        [
          -16.11404308956776,
          -15.912506650384417,
          7.938220525357162
        ],
        [
          -13.806876668119987,
          -16.133887264729523,
          8.795941042229176
        ],
        [
          -17.180207429111345,
          -16.46100509104371,
          7.488193972139301
        ],
        [
          -17.47789207498627,
          -17.74026477894906,
          7.498313208175446
        ],
        [
          -16.75118754387412,
          -20.062634076664697,
          8.01696926249819
        ],
        [
          -12.948370692278154,
          -15.780905322188113,
          7.52957037711188
        ],
        [
          -14.015036564072346,
          -14.846009246402417,
          9.599660444912347
        ],
        [
          -17.647045602259684,
          -20.556076655414703,
          9.189309788678148
        ],
        [
          -17.183824595874693,
          -20.627904100781635,
          6.778349075324557
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_21",
      "score": -1.9360272730335266,
      "energy": -5.772823485005916,
      "binding_affinity": -6.3706110315102045,
      "ic50": 21371.23777798456,
      "ic50_nm": 21371.23777798456,
      "ligand_efficiency": -0.4900470024238619,
      "rmsd": null,
      "confidence": 0.7549271759806955,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2806234834783161,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3032894693742603,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.807397706155477,
          -15.938892374286871,
          8.313832400824985
        ],
        [
          -15.931900435499683,
          -17.193697819986873,
          8.176896773947526
        ],
        [
          -16.654615293535887,
          -18.384464553252418,
          7.7572934658415065
        ],
        [
          -14.728531083421155,
          -17.19719573942417,
          8.579497085959293
        ],
        [
          -15.836268000790215,
          -19.48797608900606,
          7.794612869622846
        ],
        [
          -18.069261128049774,
          -18.320190324282642,
          7.364170084759415
        ],
        [
          -14.539392793676443,
          -19.586704541331553,
          8.134286617631336
        ],
        [
          -13.983993329929334,
          -18.454137145929685,
          8.644627136010449
        ],
        [
          -14.012833916836026,
          -15.980834157192858,
          8.983148565926307
        ],
        [
          -18.237120749173542,
          -18.409392908897615,
          5.8261439211103685
        ],
        [
          -18.865726965629293,
          -19.583648560905896,
          8.015961484642524
        ],
        [
          -13.677928747716162,
          -15.89042358200903,
          10.461928381606409
        ],
        [
          -12.755029849587004,
          -15.672442203494386,
          8.28760121211694
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_20",
      "score": -1.8414895056677112,
      "energy": -7.376325974399367,
      "binding_affinity": -6.155499259054112,
      "ic50": 30727.265194209765,
      "ic50_nm": 30727.265194209765,
      "ligand_efficiency": -0.4734999430041625,
      "rmsd": null,
      "confidence": 0.8116808156988664,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2857098671693388,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3051759608005993,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.635054152152357,
          -17.401355393482397,
          9.756793288823193
        ],
        [
          -15.317731348771217,
          -17.602651071853273,
          8.535121594130878
        ],
        [
          -16.386453457831323,
          -16.68245170779212,
          8.401531407292891
        ],
        [
          -15.109961651735901,
          -18.698516518818504,
          7.976114722711982
        ],
        [
          -17.195626187830428,
          -16.9962143707602,
          7.259590276185638
        ],
        [
          -16.547491786728905,
          -15.466420689723945,
          9.140154748123884
        ],
        [
          -16.986745995725276,
          -18.101795899409375,
          6.3413449482067294
        ],
        [
          -15.964984157505473,
          -19.033015335480943,
          6.78196234920797
        ],
        [
          -14.096722547824225,
          -19.774799006813723,
          8.167384834395992
        ],
        [
          -15.977917751636284,
          -14.209946738864792,
          8.624922877766949
        ],
        [
          -18.084684372841643,
          -15.24965639788498,
          9.468415198426694
        ],
        [
          -14.549586635683195,
          -20.894046506681157,
          8.8562906763832
        ],
        [
          -13.247039953733772,
          -19.98913036243457,
          7.030373078343995
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.2826749593963652,
        "min": 0.27238695666218976,
        "max": 0.2972506964539289,
        "std": 0.006848581141739564
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.3050725163118888,
        "min": -1.31180819124388,
        "max": -1.297010467292391,
        "std": 0.003614190045794148
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_23",
        "ml_pose_28",
        "ml_pose_4",
        "ml_pose_16",
        "ml_pose_5",
        "ml_pose_24",
        "ml_pose_11",
        "ml_pose_12",
        "ml_pose_21",
        "ml_pose_20"
      ],
      "total_energy": [
        -6.158045241964486,
        -9.11337442372388,
        -6.193562006603109,
        -9.306036942778537,
        -6.011965335406368,
        -5.589953316076203,
        -5.117627114994381,
        -6.453730802208021,
        -5.772823485005916,
        -7.376325974399367
      ],
      "vdw": [
        0.2780908933046396,
        0.27238695666218976,
        0.28880821025891484,
        0.28109330879138594,
        0.2749329004941289,
        0.28136623030034746,
        0.2864870470504617,
        0.2972506964539289,
        0.2806234834783161,
        0.2857098671693388
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3034076378220905,
        -1.31180819124388,
        -1.3054022619007464,
        -1.3065843238886594,
        -1.308086207150416,
        -1.303796611187093,
        -1.297010467292391,
        -1.306164032458749,
        -1.3032894693742603,
        -1.3051759608005993
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -10.82722700965323,
      -10.404470460992984,
      -8.575941283744505,
      -8.384520604502093,
      -7.632443715152115,
      -6.700221784475179,
      -6.7022776593221955,
      -6.847736633728349,
      -6.3706110315102045,
      -6.155499259054112
    ],
    "ic50_distribution": [
      11.55504614643794,
      23.587734999428243,
      516.589065875896,
      713.6281368006452,
      2539.831003294111,
      12251.760012716764,
      12209.316713947064,
      9551.206417628673,
      21371.23777798456,
      30727.265194209765
    ],
    "ligand_efficiency_distribution": [
      -0.8328636161271715,
      -0.8003438816148449,
      -0.6596877910572696,
      -0.6449631234232379,
      -0.5871110550117011,
      -0.51540167572886,
      -0.5155598199478612,
      -0.5267489718252576,
      -0.4900470024238619,
      -0.4734999430041625
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 12.55504614643794,
        "delta_g": -10.82722700965323,
        "ligand_efficiency": -0.8328636161271715,
        "lipophilic_efficiency": 5.401181686686103,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 24.587734999428243,
        "delta_g": -10.404470460992984,
        "ligand_efficiency": -0.8003438816148449,
        "lipophilic_efficiency": 5.109281476245267,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 517.5890658758959,
        "delta_g": -8.575941283744505,
        "ligand_efficiency": -0.6596877910572696,
        "lipophilic_efficiency": 3.786014906759603,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 714.628136800645,
        "delta_g": -8.384520604502093,
        "ligand_efficiency": -0.6449631234232379,
        "lipophilic_efficiency": 3.6459198884740553,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 2540.8310032941104,
        "delta_g": -7.632443715152115,
        "ligand_efficiency": -0.5871110550117011,
        "lipophilic_efficiency": 3.0950242199467146,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 6,
        "max_score": 10,
        "drug_likeness_category": "good"
      },
      {
        "ic50": 12252.760012716764,
        "delta_g": -6.700221784475179,
        "ligand_efficiency": -0.51540167572886,
        "lipophilic_efficiency": 2.4117660726643466,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 12210.316713947066,
        "delta_g": -6.7022776593221955,
        "ligand_efficiency": -0.5155598199478612,
        "lipophilic_efficiency": 2.4132730710808605,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 9552.206417628675,
        "delta_g": -6.847736633728349,
        "ligand_efficiency": -0.5267489718252576,
        "lipophilic_efficiency": 2.5198963012619746,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 21372.237777984563,
        "delta_g": -6.3706110315102045,
        "ligand_efficiency": -0.4900470024238619,
        "lipophilic_efficiency": 2.1701500026955625,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 30728.265194209762,
        "delta_g": -6.155499259054112,
        "ligand_efficiency": -0.4734999430041625,
        "lipophilic_efficiency": 2.0124619577341543,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.538736276124115,
        "length": 5.357638439715618,
        "width": 4.724339250726182,
        "height": 3.298606086208027
      },
      {
        "radius_of_gyration": 2.529777191042522,
        "length": 5.709474071016176,
        "width": 4.1675157100246665,
        "height": 4.1917516304168085
      },
      {
        "radius_of_gyration": 2.520424896762857,
        "length": 5.934123156766086,
        "width": 3.4549529264251895,
        "height": 5.297378406354198
      },
      {
        "radius_of_gyration": 2.5298833393090447,
        "length": 3.824046837145813,
        "width": 4.557114666884097,
        "height": 6.969403160182351
      },
      {
        "radius_of_gyration": 2.547622858328259,
        "length": 3.7488031676501876,
        "width": 5.815402035412923,
        "height": 6.525978244151495
      },
      {
        "radius_of_gyration": 2.5374119100856056,
        "length": 6.055866625610621,
        "width": 4.0372662040220035,
        "height": 6.035538335561936
      },
      {
        "radius_of_gyration": 2.538127880601677,
        "length": 6.231347391712275,
        "width": 6.042325035572528,
        "height": 3.897400208042461
      },
      {
        "radius_of_gyration": 2.511575789440649,
        "length": 4.698674909981531,
        "width": 5.7818948543792175,
        "height": 2.8213113695877903
      },
      {
        "radius_of_gyration": 2.543874690577603,
        "length": 6.110697116042289,
        "width": 3.914262337837167,
        "height": 4.6357844604960405
      },
      {
        "radius_of_gyration": 2.532635370156617,
        "length": 4.837644419107871,
        "width": 6.684099767816365,
        "height": 3.4154483406164635
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        -2.947008428337546,
        -6.158045241964486
      ],
      [
        -2.7444591563455947,
        -9.11337442372388
      ],
      [
        -2.39575335616387,
        -6.193562006603109
      ],
      [
        -2.2712322943409475,
        -9.306036942778537
      ],
      [
        -2.225561408655449,
        -6.011965335406368
      ],
      [
        -2.0405947610301567,
        -5.589953316076203
      ],
      [
        -2.0301396884188043,
        -5.117627114994381
      ],
      [
        -2.00046551758158,
        -6.453730802208021
      ],
      [
        -1.9360272730335266,
        -5.772823485005916
      ],
      [
        -1.8414895056677112,
        -7.376325974399367
      ]
    ],
    "score_vs_interactions": [
      [
        -2.947008428337546,
        0
      ],
      [
        -2.7444591563455947,
        0
      ],
      [
        -2.39575335616387,
        0
      ],
      [
        -2.2712322943409475,
        0
      ],
      [
        -2.225561408655449,
        0
      ],
      [
        -2.0405947610301567,
        0
      ],
      [
        -2.0301396884188043,
        0
      ],
      [
        -2.00046551758158,
        0
      ],
      [
        -1.9360272730335266,
        0
      ],
      [
        -1.8414895056677112,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -6.158045241964486,
        0
      ],
      [
        -9.11337442372388,
        0
      ],
      [
        -6.193562006603109,
        0
      ],
      [
        -9.306036942778537,
        0
      ],
      [
        -6.011965335406368,
        0
      ],
      [
        -5.589953316076203,
        0
      ],
      [
        -5.117627114994381,
        0
      ],
      [
        -6.453730802208021,
        0
      ],
      [
        -5.772823485005916,
        0
      ],
      [
        -7.376325974399367,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -10.82722700965323,
        -0.8328636161271715
      ],
      [
        -10.404470460992984,
        -0.8003438816148449
      ],
      [
        -8.575941283744505,
        -0.6596877910572696
      ],
      [
        -8.384520604502093,
        -0.6449631234232379
      ],
      [
        -7.632443715152115,
        -0.5871110550117011
      ],
      [
        -6.700221784475179,
        -0.51540167572886
      ],
      [
        -6.7022776593221955,
        -0.5155598199478612
      ],
      [
        -6.847736633728349,
        -0.5267489718252576
      ],
      [
        -6.3706110315102045,
        -0.4900470024238619
      ],
      [
        -6.155499259054112,
        -0.4734999430041625
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        
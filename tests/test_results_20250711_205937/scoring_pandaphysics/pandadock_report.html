
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-11T21:01:32.293575 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-11T21:01:32.293575",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandaphysics",
    "num_poses": 10,
    "flexible_residues": []
  },
  "summary": {
    "total_poses": 10,
    "best_score": 0.13986224856034601,
    "worst_score": 0.32817978957653815,
    "mean_score": 0.24485629987347357,
    "score_range": 0.18831754101619214,
    "best_energy": -8.76556781547118,
    "worst_energy": -4.910758354206909,
    "mean_energy": -6.403180793177407,
    "energy_range": 3.8548094612642707,
    "best_binding_affinity": -11.70275502879308,
    "mean_binding_affinity": -9.602874002530529,
    "best_ic50": 2.6359624583422203,
    "mean_ic50": 406.8238030499439
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_9",
      "score": 0.13986224856034601,
      "energy": -5.985459656471669,
      "binding_affinity": -11.70275502879308,
      "ic50": 2.6359624583422203,
      "ic50_nm": 2.6359624583422203,
      "ligand_efficiency": -0.9002119252917754,
      "rmsd": null,
      "confidence": 0.860137751439654,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27344010972911104,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3022685629100617,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.20828033057993,
          -16.523991258227667,
          8.799263419395523
        ],
        [
          -15.298431834982672,
          -17.294672194633893,
          8.32854200556422
        ],
        [
          -15.249013174858582,
          -18.568157827066756,
          8.944172630291838
        ],
        [
          -16.3149541040096,
          -16.96229232801401,
          7.500057454469214
        ],
        [
          -16.26898594656951,
          -19.569699235891253,
          8.517340206418556
        ],
        [
          -14.1565202108416,
          -19.12315525474326,
          9.76390468424226
        ],
        [
          -17.271901080514464,
          -18.983769635028317,
          7.523177957773822
        ],
        [
          -17.260991142680126,
          -17.79747898347386,
          7.072498623178163
        ],
        [
          -16.331466049500612,
          -15.461936654008099,
          6.786071624037465
        ],
        [
          -14.697987398749753,
          -19.1050348374762,
          11.26498235798342
        ],
        [
          -13.68558008308905,
          -20.486418739363696,
          9.409697434466736
        ],
        [
          -15.779977260339031,
          -15.382104575591022,
          5.390011960636258
        ],
        [
          -17.575911383285064,
          -14.84128847648195,
          7.040279641542526
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_0",
      "score": 0.15701412373713186,
      "energy": -8.108800301004953,
      "binding_affinity": -11.359717525257363,
      "ic50": 4.7034150441778095,
      "ic50_nm": 4.7034150441778095,
      "ligand_efficiency": -0.8738244250197972,
      "rmsd": null,
      "confidence": 0.8429858762628681,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27727312834704404,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3056977161597683,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.534188560245727,
          -17.335016054608545,
          6.247930847530829
        ],
        [
          -15.634880844210143,
          -17.59288142286852,
          7.613452198022218
        ],
        [
          -14.833034193503211,
          -18.58269774539712,
          8.114885041840791
        ],
        [
          -16.503531566331787,
          -16.927888468112595,
          8.328175410789484
        ],
        [
          -15.1146015891416,
          -18.84237201504602,
          9.563456128892977
        ],
        [
          -13.799152516678229,
          -19.325041124753206,
          7.33152064531005
        ],
        [
          -15.957996729935275,
          -18.206012033479123,
          10.354917525404213
        ],
        [
          -16.686227032984313,
          -17.129721474048885,
          9.727597013581823
        ],
        [
          -17.462707732217655,
          -15.82839575283337,
          7.804323569321878
        ],
        [
          -12.432355237246318,
          -18.695995746775736,
          7.479587654059045
        ],
        [
          -13.95147350139121,
          -20.77462485623241,
          7.723764261107478
        ],
        [
          -18.81945230869368,
          -16.4161266241319,
          7.5328793626816335
        ],
        [
          -17.370398187420857,
          -14.443226681712554,
          8.517510341457585
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_20",
      "score": 0.19715155375905136,
      "energy": -6.510938732514096,
      "binding_affinity": -10.556968924818973,
      "ic50": 18.23444710292039,
      "ic50_nm": 18.23444710292039,
      "ligand_efficiency": -0.8120745326783825,
      "rmsd": null,
      "confidence": 0.8028484462409486,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2848534618522361,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3028260292390008,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.585239078265726,
          -15.959761493353653,
          9.136146195667402
        ],
        [
          -15.758565983285177,
          -17.1856952444459,
          8.57763232188221
        ],
        [
          -15.804048661501906,
          -17.25436611600283,
          7.11472283795589
        ],
        [
          -15.535917274313942,
          -18.438817564362108,
          9.117493361309535
        ],
        [
          -15.737552975709775,
          -18.456267687095043,
          6.47180182101755
        ],
        [
          -15.904026538676977,
          -15.954991132147875,
          6.211124521899551
        ],
        [
          -15.753581959700409,
          -19.537988650510442,
          7.154349889313938
        ],
        [
          -15.56816245244023,
          -19.471913444805526,
          8.483786634455651
        ],
        [
          -15.54194517873108,
          -18.40015773837651,
          10.73497781355601
        ],
        [
          -14.617995189109994,
          -15.457226521610249,
          5.689074918237556
        ],
        [
          -17.026763465496302,
          -16.010568698846797,
          5.174191909685548
        ],
        [
          -16.926115700413323,
          -18.847238295639368,
          11.267704291569151
        ],
        [
          -14.34008554235518,
          -19.125007412803686,
          11.206993483450004
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_1",
      "score": 0.19777416704739115,
      "energy": -5.192838702908544,
      "binding_affinity": -10.544516659052178,
      "ic50": 18.621776581043992,
      "ic50_nm": 18.621776581043992,
      "ligand_efficiency": -0.8111166660809368,
      "rmsd": null,
      "confidence": 0.8022258329526089,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2697759819039207,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3072983909970586,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.09281621709176,
          -17.70022174186777,
          7.020257699368571
        ],
        [
          -15.136874331771278,
          -17.743230766303892,
          7.789861360386201
        ],
        [
          -15.179739873184559,
          -16.951454428380156,
          8.993264391445498
        ],
        [
          -16.30893951110641,
          -18.539709820523584,
          7.551615713167831
        ],
        [
          -16.304079213284304,
          -16.922491164368964,
          9.734916603015574
        ],
        [
          -14.027679113655356,
          -16.036013558311744,
          9.239251184827138
        ],
        [
          -17.50235098791589,
          -17.745013862744102,
          9.590760976440412
        ],
        [
          -17.477590403683145,
          -18.408009105005657,
          8.35240149139823
        ],
        [
          -16.276687604770366,
          -19.369560730500478,
          6.337162146650249
        ],
        [
          -14.29675757531911,
          -14.532089861725295,
          8.85067831783881
        ],
        [
          -13.778816192112316,
          -16.177677163054682,
          10.814569126902796
        ],
        [
          -16.12439644465493,
          -20.888518015722106,
          6.659465409628805
        ],
        [
          -17.593272531450573,
          -19.08600978149157,
          5.405795578929892
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_4",
      "score": 0.23886913673001708,
      "energy": -4.910758354206909,
      "binding_affinity": -9.72261726539966,
      "ic50": 74.56576521610079,
      "ic50_nm": 74.56576521610079,
      "ligand_efficiency": -0.7478936357999738,
      "rmsd": null,
      "confidence": 0.7611308632699829,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28129116948379856,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3063447360946157,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.372017379802653,
          -18.491684230651675,
          7.521225702271488
        ],
        [
          -16.20513547349263,
          -17.92858688214168,
          7.9813854193658695
        ],
        [
          -15.208114953825383,
          -17.928270641967487,
          7.109933025903343
        ],
        [
          -16.235522487789357,
          -17.448076737674327,
          9.214736845347662
        ],
        [
          -13.84452803642391,
          -17.450136038066915,
          7.599724876133315
        ],
        [
          -15.155703769027113,
          -18.499741501411116,
          5.739312652140269
        ],
        [
          -13.802958450334831,
          -16.919283487631926,
          8.928365880091842
        ],
        [
          -14.894724860585114,
          -16.91022935578087,
          9.742908140097523
        ],
        [
          -17.299117209104846,
          -17.36415445479688,
          10.273034894862866
        ],
        [
          -15.275215677231916,
          -17.32845443015804,
          4.803607767277548
        ],
        [
          -13.99330765081374,
          -19.35664397190434,
          5.40347420071911
        ],
        [
          -17.263855604184794,
          -18.419182864563417,
          11.241798481735366
        ],
        [
          -17.549798447383676,
          -16.055555403251297,
          10.780492114053812
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_21",
      "score": 0.27152653408352334,
      "energy": -8.386236262755666,
      "binding_affinity": -9.069469318329533,
      "ic50": 224.56882260271857,
      "ic50_nm": 224.56882260271857,
      "ligand_efficiency": -0.6976514860253487,
      "rmsd": null,
      "confidence": 0.7284734659164767,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.29156240420987034,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3016731314109724,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -13.997312661425116,
          -17.331656876146713,
          7.511055544168411
        ],
        [
          -15.229290910070521,
          -17.610091282354006,
          7.923624629891016
        ],
        [
          -15.898141265998115,
          -16.55613181943138,
          8.446374885173018
        ],
        [
          -15.662660270910653,
          -18.86683295936303,
          7.886071004068253
        ],
        [
          -17.174351937123227,
          -16.873305110167856,
          8.995910216083946
        ],
        [
          -15.351879997991562,
          -15.16010397682289,
          8.481640305973432
        ],
        [
          -17.65024791460568,
          -18.07398122967275,
          9.104202944011952
        ],
        [
          -16.83250331316181,
          -19.12815186236142,
          8.45799954728022
        ],
        [
          -14.720954799292569,
          -19.976221099552667,
          7.3806308674754995
        ],
        [
          -16.156101516584954,
          -14.31681992232515,
          7.343306505057079
        ],
        [
          -15.68561616001956,
          -14.481004385489614,
          9.83937635178053
        ],
        [
          -14.045610999632128,
          -20.893789883056947,
          8.47550125390207
        ],
        [
          -15.695328253184105,
          -20.83190959325556,
          6.494305945134528
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_11",
      "score": 0.29766808675501,
      "energy": -5.003430626667722,
      "binding_affinity": -8.5466382648998,
      "ic50": 542.7835530024657,
      "ic50_nm": 542.7835530024657,
      "ligand_efficiency": -0.6574337126845999,
      "rmsd": null,
      "confidence": 0.70233191324499,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28443431194195706,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3025007022412263,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.63822492274471,
          -19.302552938808986,
          8.284176658960913
        ],
        [
          -15.300096513223746,
          -18.160035003049494,
          8.21917265501297
        ],
        [
          -15.9417600924784,
          -17.767906324442126,
          7.035416308942378
        ],
        [
          -15.722766666778675,
          -17.437864974347097,
          9.363766170619126
        ],
        [
          -16.59144919726984,
          -16.618167799588328,
          6.986933002017619
        ],
        [
          -15.763345160943679,
          -18.670384921316188,
          5.766061248564139
        ],
        [
          -16.851370092019394,
          -15.851500578415752,
          8.169379680172959
        ],
        [
          -16.310322771016047,
          -16.22957182531536,
          9.135821325651799
        ],
        [
          -14.940155538991192,
          -17.809989411373977,
          10.651876983887856
        ],
        [
          -16.98627025948627,
          -19.531676713898563,
          5.462494318284288
        ],
        [
          -15.3588067114563,
          -17.78957259557625,
          4.494400010264714
        ],
        [
          -13.716674297722381,
          -16.99763078349136,
          11.013583296295106
        ],
        [
          -15.978757775869337,
          -17.933146130376507,
          11.756918341326116
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_28",
      "score": 0.309183300540518,
      "energy": -8.76556781547118,
      "binding_affinity": -8.31633398918964,
      "ic50": 800.6786325587021,
      "ic50_nm": 800.6786325587021,
      "ligand_efficiency": -0.6397179991684339,
      "rmsd": null,
      "confidence": 0.690816699459482,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2800521240596113,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3091286094118555,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.802509090919454,
          -19.082003503255983,
          7.099739898165918
        ],
        [
          -15.445308830033898,
          -18.107359981497495,
          7.804817912580248
        ],
        [
          -14.722965025498896,
          -17.451688770583225,
          8.892269597158489
        ],
        [
          -16.806932237801483,
          -17.861185868090367,
          7.638695573480724
        ],
        [
          -15.40331545925908,
          -16.49165684559248,
          9.673432196741256
        ],
        [
          -13.17195615221325,
          -17.773662285592838,
          9.029146174554139
        ],
        [
          -16.727881188515653,
          -16.229767879314792,
          9.397962042467796
        ],
        [
          -17.365345538723073,
          -16.900703266192977,
          8.490918669898065
        ],
        [
          -17.512865672034117,
          -18.463293822244598,
          6.524464269203728
        ],
        [
          -12.372091216961508,
          -16.76583737670901,
          8.411399383743014
        ],
        [
          -12.992739864792528,
          -17.879156478507934,
          10.511876591656414
        ],
        [
          -18.512511743540713,
          -19.56587294218433,
          7.169061145853838
        ],
        [
          -18.263577979706344,
          -17.527810980233983,
          5.696216544496371
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_7",
      "score": 0.31133405794520885,
      "energy": -6.076562141692356,
      "binding_affinity": -8.273318841095822,
      "ic50": 860.977500473489,
      "ic50_nm": 860.977500473489,
      "ligand_efficiency": -0.6364091416227555,
      "rmsd": null,
      "confidence": 0.6886659420547911,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28128268554010316,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3015439436046996,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.928774594099057,
          -19.293961041736036,
          6.913456883638645
        ],
        [
          -15.784454429798563,
          -18.047340223081026,
          7.767805079776092
        ],
        [
          -16.810420439190946,
          -17.292690320526454,
          7.987398011312362
        ],
        [
          -14.647680323529679,
          -17.910164672085163,
          8.45998301750597
        ],
        [
          -16.630083250764613,
          -16.16583386249441,
          8.832486214011363
        ],
        [
          -18.174932917113466,
          -17.50769286166863,
          7.43576416414101
        ],
        [
          -15.434005025067883,
          -16.02344166317973,
          9.509150433040283
        ],
        [
          -14.401647559610137,
          -16.872078449932907,
          9.350027567715307
        ],
        [
          -13.374199121825905,
          -18.933242614716292,
          8.133936305180754
        ],
        [
          -19.12693114070612,
          -18.111225949025496,
          8.208992948702589
        ],
        [
          -18.68125243990973,
          -16.18688919605883,
          6.72712401502439
        ],
        [
          -12.310845806082952,
          -18.276295031046807,
          7.425904321451359
        ],
        [
          -12.794772952300947,
          -19.479144114448204,
          9.587971038499893
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_10",
      "score": 0.32817978957653815,
      "energy": -5.091215338080964,
      "binding_affinity": -7.936404208469237,
      "ic50": 1520.4681554594783,
      "ic50_nm": 1520.4681554594783,
      "ligand_efficiency": -0.6104926314207105,
      "rmsd": null,
      "confidence": 0.6718202104234618,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.26822813625599606,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3080826161212706,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.3214677611054,
          -16.214427152984737,
          8.122542142102672
        ],
        [
          -15.219889173386209,
          -17.214260205590097,
          8.217143215079638
        ],
        [
          -15.967647966600117,
          -17.58557527821902,
          9.320105874926803
        ],
        [
          -15.65012827008798,
          -17.88628102296957,
          6.977049842628061
        ],
        [
          -16.820883614874802,
          -18.65084628815561,
          9.42652337470091
        ],
        [
          -15.579931468355678,
          -16.846962147652356,
          10.617392762038158
        ],
        [
          -17.22216287073745,
          -19.339640093504332,
          8.282107978081235
        ],
        [
          -16.530956913422713,
          -19.061706927045797,
          7.090663416735503
        ],
        [
          -14.964779886574737,
          -17.644878039447146,
          5.69127731693631
        ],
        [
          -16.58935629754773,
          -15.774541731552812,
          10.964432191205583
        ],
        [
          -15.303907962625829,
          -17.740093187663966,
          11.748261189028364
        ],
        [
          -13.861436416929475,
          -18.729059899613826,
          5.245369829820605
        ],
        [
          -16.067451397751874,
          -17.41172802560068,
          4.6371308667161415
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.2792193513323648,
        "min": 0.26822813625599606,
        "max": 0.29156240420987034,
        "std": 0.006838893998313894
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.3047364438190527,
        "min": -1.3091286094118555,
        "max": -1.3015439436046996,
        "std": 0.0027363627418506863
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_9",
        "ml_pose_0",
        "ml_pose_20",
        "ml_pose_1",
        "ml_pose_4",
        "ml_pose_21",
        "ml_pose_11",
        "ml_pose_28",
        "ml_pose_7",
        "ml_pose_10"
      ],
      "total_energy": [
        -5.985459656471669,
        -8.108800301004953,
        -6.510938732514096,
        -5.192838702908544,
        -4.910758354206909,
        -8.386236262755666,
        -5.003430626667722,
        -8.76556781547118,
        -6.076562141692356,
        -5.091215338080964
      ],
      "vdw": [
        0.27344010972911104,
        0.27727312834704404,
        0.2848534618522361,
        0.2697759819039207,
        0.28129116948379856,
        0.29156240420987034,
        0.28443431194195706,
        0.2800521240596113,
        0.28128268554010316,
        0.26822813625599606
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3022685629100617,
        -1.3056977161597683,
        -1.3028260292390008,
        -1.3072983909970586,
        -1.3063447360946157,
        -1.3016731314109724,
        -1.3025007022412263,
        -1.3091286094118555,
        -1.3015439436046996,
        -1.3080826161212706
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -11.70275502879308,
      -11.359717525257363,
      -10.556968924818973,
      -10.544516659052178,
      -9.72261726539966,
      -9.069469318329533,
      -8.5466382648998,
      -8.31633398918964,
      -8.273318841095822,
      -7.936404208469237
    ],
    "ic50_distribution": [
      2.6359624583422203,
      4.7034150441778095,
      18.23444710292039,
      18.621776581043992,
      74.56576521610079,
      224.56882260271857,
      542.7835530024657,
      800.6786325587021,
      860.977500473489,
      1520.4681554594783
    ],
    "ligand_efficiency_distribution": [
      -0.9002119252917754,
      -0.8738244250197972,
      -0.8120745326783825,
      -0.8111166660809368,
      -0.7478936357999738,
      -0.6976514860253487,
      -0.6574337126845999,
      -0.6397179991684339,
      -0.6364091416227555,
      -0.6104926314207105
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 3.6359624583422208,
        "delta_g": -11.70275502879308,
        "ligand_efficiency": -0.9002119252917754,
        "lipophilic_efficiency": 5.939380609558702,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 5.7034150441778095,
        "delta_g": -11.359717525257363,
        "ligand_efficiency": -0.8738244250197972,
        "lipophilic_efficiency": 5.7438650231479365,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 19.23444710292039,
        "delta_g": -10.556968924818973,
        "ligand_efficiency": -0.8120745326783825,
        "lipophilic_efficiency": 5.215920293038052,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 19.621776581043992,
        "delta_g": -10.544516659052178,
        "ligand_efficiency": -0.8111166660809368,
        "lipophilic_efficiency": 5.207261673591441,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 75.56576521610079,
        "delta_g": -9.72261726539966,
        "ligand_efficiency": -0.7478936357999738,
        "lipophilic_efficiency": 4.621674915413722,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 225.5688226027186,
        "delta_g": -9.069469318329533,
        "ligand_efficiency": -0.6976514860253487,
        "lipophilic_efficiency": 4.146720927327418,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 543.7835530024659,
        "delta_g": -8.5466382648998,
        "ligand_efficiency": -0.6574337126845999,
        "lipophilic_efficiency": 3.7645739319973073,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 801.6786325587021,
        "delta_g": -8.31633398918964,
        "ligand_efficiency": -0.6397179991684339,
        "lipophilic_efficiency": 3.5959996916620796,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 861.9775004734889,
        "delta_g": -8.273318841095822,
        "ligand_efficiency": -0.6364091416227555,
        "lipophilic_efficiency": 3.5645040700775334,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 1521.4681554594783,
        "delta_g": -7.936404208469237,
        "ligand_efficiency": -0.6104926314207105,
        "lipophilic_efficiency": 3.3177371330547176,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 6,
        "max_score": 10,
        "drug_likeness_category": "good"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.567120734538288,
        "length": 3.8903313001960136,
        "width": 5.645130262881747,
        "height": 5.8749703973471625
      },
      {
        "radius_of_gyration": 2.5305716359467674,
        "length": 6.3870970714473625,
        "width": 6.331398174519856,
        "height": 4.106986677873384
      },
      {
        "radius_of_gyration": 2.5390590984668457,
        "length": 2.686677923141122,
        "width": 4.080762128900194,
        "height": 6.0935123818836034
      },
      {
        "radius_of_gyration": 2.544211640756681,
        "length": 3.814456339338257,
        "width": 6.356428153996811,
        "height": 5.408773547972904
      },
      {
        "radius_of_gyration": 2.5365461490810075,
        "length": 3.746839997048845,
        "width": 3.301088568653043,
        "height": 6.438190714457818
      },
      {
        "radius_of_gyration": 2.5260502675992087,
        "length": 3.652935253180562,
        "width": 6.576969960731796,
        "height": 3.345070406646002
      },
      {
        "radius_of_gyration": 2.533770668562576,
        "length": 3.269595961763887,
        "width": 3.68017613548281,
        "height": 7.262518331061402
      },
      {
        "radius_of_gyration": 2.527126491978847,
        "length": 6.140420526579206,
        "width": 3.336105062869539,
        "height": 4.815660047160042
      },
      {
        "radius_of_gyration": 2.54224969877633,
        "length": 6.816085334623168,
        "width": 3.455702451268472,
        "height": 2.860847023475503
      },
      {
        "radius_of_gyration": 2.5463827883743253,
        "length": 3.360726453807974,
        "width": 3.56509836195152,
        "height": 7.111130322312222
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        0.13986224856034601,
        -5.985459656471669
      ],
      [
        0.15701412373713186,
        -8.108800301004953
      ],
      [
        0.19715155375905136,
        -6.510938732514096
      ],
      [
        0.19777416704739115,
        -5.192838702908544
      ],
      [
        0.23886913673001708,
        -4.910758354206909
      ],
      [
        0.27152653408352334,
        -8.386236262755666
      ],
      [
        0.29766808675501,
        -5.003430626667722
      ],
      [
        0.309183300540518,
        -8.76556781547118
      ],
      [
        0.31133405794520885,
        -6.076562141692356
      ],
      [
        0.32817978957653815,
        -5.091215338080964
      ]
    ],
    "score_vs_interactions": [
      [
        0.13986224856034601,
        0
      ],
      [
        0.15701412373713186,
        0
      ],
      [
        0.19715155375905136,
        0
      ],
      [
        0.19777416704739115,
        0
      ],
      [
        0.23886913673001708,
        0
      ],
      [
        0.27152653408352334,
        0
      ],
      [
        0.29766808675501,
        0
      ],
      [
        0.309183300540518,
        0
      ],
      [
        0.31133405794520885,
        0
      ],
      [
        0.32817978957653815,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -5.985459656471669,
        0
      ],
      [
        -8.108800301004953,
        0
      ],
      [
        -6.510938732514096,
        0
      ],
      [
        -5.192838702908544,
        0
      ],
      [
        -4.910758354206909,
        0
      ],
      [
        -8.386236262755666,
        0
      ],
      [
        -5.003430626667722,
        0
      ],
      [
        -8.76556781547118,
        0
      ],
      [
        -6.076562141692356,
        0
      ],
      [
        -5.091215338080964,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -11.70275502879308,
        -0.9002119252917754
      ],
      [
        -11.359717525257363,
        -0.8738244250197972
      ],
      [
        -10.556968924818973,
        -0.8120745326783825
      ],
      [
        -10.544516659052178,
        -0.8111166660809368
      ],
      [
        -9.72261726539966,
        -0.7478936357999738
      ],
      [
        -9.069469318329533,
        -0.6976514860253487
      ],
      [
        -8.5466382648998,
        -0.6574337126845999
      ],
      [
        -8.31633398918964,
        -0.6397179991684339
      ],
      [
        -8.273318841095822,
        -0.6364091416227555
      ],
      [
        -7.936404208469237,
        -0.6104926314207105
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        
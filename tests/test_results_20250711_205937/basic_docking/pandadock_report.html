
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-11T20:59:39.666820 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-11T20:59:39.666820",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": []
  },
  "summary": {
    "total_poses": 10,
    "best_score": 0.13109867566428557,
    "worst_score": 0.28891650039589,
    "mean_score": 0.22528254876890852,
    "score_range": 0.15781782473160444,
    "best_energy": -8.73245129330115,
    "worst_energy": -5.281253224255214,
    "mean_energy": -6.525540792524478,
    "energy_range": 3.451198069045936,
    "best_binding_affinity": -11.878026486714289,
    "mean_binding_affinity": -9.99434902462183,
    "best_ic50": 1.9608805718161195,
    "mean_ic50": 118.18645047241682
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_23",
      "score": 0.13109867566428557,
      "energy": -6.465031166592185,
      "binding_affinity": -11.878026486714289,
      "ic50": 1.9608805718161195,
      "ic50_nm": 1.9608805718161195,
      "ligand_efficiency": -0.9136943451318683,
      "rmsd": null,
      "confidence": 0.8689013243357144,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2779414112922622,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3039167761864812,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.848895430859038,
          -18.748074154754143,
          9.419900778171497
        ],
        [
          -16.029796762860016,
          -18.01801776310007,
          8.566925558328881
        ],
        [
          -14.834690682602737,
          -17.6503941865275,
          8.963139235211452
        ],
        [
          -16.49188224550469,
          -17.664690344412314,
          7.26757021104954
        ],
        [
          -13.992276834244318,
          -16.779840004227317,
          8.096798712132525
        ],
        [
          -14.287056854331539,
          -17.947529054697878,
          10.341685762900608
        ],
        [
          -14.500353281633043,
          -16.48005072702105,
          6.900448691806698
        ],
        [
          -15.761567369687892,
          -16.94866148328356,
          6.410161623015991
        ],
        [
          -17.883459223631732,
          -18.140309402719755,
          6.791950918752269
        ],
        [
          -13.281347177259093,
          -19.106874910323086,
          10.35670642680457
        ],
        [
          -13.62358505198971,
          -16.738020732105575,
          11.03893095260114
        ],
        [
          -18.885427988999723,
          -17.059925158747287,
          6.762477218706934
        ],
        [
          -17.6796610963965,
          -18.817612078080465,
          5.423303910517916
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_28",
      "score": 0.18499992981107183,
      "energy": -6.786231347594527,
      "binding_affinity": -10.800001403778563,
      "ic50": 12.09846418817695,
      "ic50_nm": 12.09846418817695,
      "ligand_efficiency": -0.8307693387521972,
      "rmsd": null,
      "confidence": 0.8150000701889282,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2773865341497368,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.2994772041320997,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.405133160879178,
          -19.270207066053185,
          9.240951629938792
        ],
        [
          -15.633808222459319,
          -18.207740787743642,
          8.420027193647133
        ],
        [
          -16.819382016188634,
          -17.9595994988409,
          7.80519542604884
        ],
        [
          -14.712538450690108,
          -17.106140337181845,
          8.509430507767892
        ],
        [
          -16.925241877247647,
          -16.96896785744178,
          6.822851517939238
        ],
        [
          -17.843468535308265,
          -19.265110980271526,
          7.834469031800417
        ],
        [
          -15.98869104123304,
          -15.983906918892153,
          6.9329891020042105
        ],
        [
          -14.892249334910037,
          -16.03333864037023,
          7.7596327685184825
        ],
        [
          -13.46090659952673,
          -17.250848313703475,
          9.367224621364883
        ],
        [
          -18.971898936068452,
          -18.942691016264032,
          8.603882237015469
        ],
        [
          -18.179408902349685,
          -19.628539214385558,
          6.26369104852116
        ],
        [
          -12.087816066212216,
          -17.517160518812002,
          8.599460674212
        ],
        [
          -13.17945685692672,
          -15.965748850039716,
          10.1801942412215
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_3",
      "score": 0.20556121583532705,
      "energy": -5.756094320263864,
      "binding_affinity": -10.38877568329346,
      "ic50": 24.220983537032833,
      "ic50_nm": 24.220983537032833,
      "ligand_efficiency": -0.7991365910225738,
      "rmsd": null,
      "confidence": 0.794438784164673,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2940339557287674,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3053799469436103,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.516138363891763,
          -17.01612687283673,
          7.8288337535461565
        ],
        [
          -16.1954763341599,
          -17.458952672194766,
          8.084354034183466
        ],
        [
          -16.011252216760504,
          -18.812728115863308,
          8.372344888464095
        ],
        [
          -15.287567728867616,
          -16.63071213325763,
          8.06946520068847
        ],
        [
          -14.784191745151208,
          -19.24120093423921,
          8.711505864904836
        ],
        [
          -17.222170482541788,
          -19.776432848329204,
          8.39770348953671
        ],
        [
          -13.78069398573825,
          -18.433466908397367,
          8.54235485943044
        ],
        [
          -13.886827432655531,
          -17.06873581171687,
          8.287293901059737
        ],
        [
          -15.402110343386742,
          -15.180713903213679,
          7.686743688727734
        ],
        [
          -17.29219908426561,
          -20.55152496746953,
          7.117805664490232
        ],
        [
          -17.205737515677967,
          -20.716750493949835,
          9.663239780842769
        ],
        [
          -15.130148350803264,
          -14.360160710111025,
          8.967321349704076
        ],
        [
          -14.385486416099841,
          -14.852493628420753,
          6.611033524421309
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_26",
      "score": 0.2155028983649736,
      "energy": -6.143356544376279,
      "binding_affinity": -10.189942032700529,
      "ic50": 33.880735847361365,
      "ic50_nm": 33.880735847361365,
      "ligand_efficiency": -0.7838416948231176,
      "rmsd": null,
      "confidence": 0.7844971016350264,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2828799914433865,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3045886448003021,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.20463245576655,
          -16.631614085729524,
          6.6469722017844415
        ],
        [
          -15.53083294808874,
          -17.377106066812647,
          7.663937140414286
        ],
        [
          -15.231423252725783,
          -16.888326432130985,
          8.927715730973196
        ],
        [
          -16.108153018972683,
          -18.57502799848321,
          7.542588816464445
        ],
        [
          -15.556512704073409,
          -17.66572932217075,
          10.135257148111041
        ],
        [
          -14.612762030452753,
          -15.63121037739104,
          9.215408302618762
        ],
        [
          -16.302219156088984,
          -19.028837729657262,
          9.833148170679305
        ],
        [
          -16.490326673125402,
          -19.37476454054004,
          8.643378365350927
        ],
        [
          -16.470599881010063,
          -19.078511185404686,
          6.161000001316115
        ],
        [
          -15.574002846244703,
          -14.49236332108106,
          9.546673835152049
        ],
        [
          -13.540179885969458,
          -15.637242312091901,
          10.356053168523527
        ],
        [
          -15.585308662390084,
          -20.209949935773853,
          5.6332320825468605
        ],
        [
          -17.893046485091325,
          -19.509316692733048,
          6.034635036065043
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_29",
      "score": 0.21600007368325436,
      "energy": -5.281253224255214,
      "binding_affinity": -10.179998526334913,
      "ic50": 34.4542042610943,
      "ic50_nm": 34.4542042610943,
      "ligand_efficiency": -0.7830768097180703,
      "rmsd": null,
      "confidence": 0.7839999263167456,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2890359063720057,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3033258427874848,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.58466565474226,
          -18.95166808617558,
          9.124944883673667
        ],
        [
          -15.35277829321165,
          -18.052509927384115,
          8.482175643770546
        ],
        [
          -16.55987215058162,
          -18.57046315622234,
          7.803358650802302
        ],
        [
          -14.969190608920812,
          -16.83872423995219,
          8.218167513953468
        ],
        [
          -17.328175173726443,
          -17.63578852849944,
          7.295646070789907
        ],
        [
          -17.007559716063867,
          -19.916177863496138,
          8.089191541125679
        ],
        [
          -16.884451274971084,
          -16.290890644865144,
          7.0742136673889675
        ],
        [
          -15.741263022702551,
          -15.866596144241353,
          7.655888934584031
        ],
        [
          -13.675397491820764,
          -16.288766669992853,
          8.994120209910932
        ],
        [
          -18.075747364740636,
          -20.074066676147087,
          9.16845601450419
        ],
        [
          -17.608665174486056,
          -20.439814798491998,
          6.791242389006861
        ],
        [
          -12.524442331777234,
          -16.09431146305755,
          7.85841132349368
        ],
        [
          -13.787791742255031,
          -15.080221801474174,
          9.78418315699573
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_18",
      "score": 0.22267769436594054,
      "energy": -7.26350380766302,
      "binding_affinity": -10.046446112681188,
      "ic50": 43.166504877926386,
      "ic50_nm": 43.166504877926386,
      "ligand_efficiency": -0.7728035471293222,
      "rmsd": null,
      "confidence": 0.7773223056340595,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2674941503741864,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3014835169756773,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.202861522245502,
          -16.2482233948457,
          6.820063706659484
        ],
        [
          -15.930388598124264,
          -17.32131515942245,
          7.781620982049246
        ],
        [
          -16.510378764481608,
          -17.458573913254433,
          9.024456413146902
        ],
        [
          -14.821691185243417,
          -18.109014685733055,
          7.524487531665402
        ],
        [
          -16.170046884875468,
          -18.36488197558016,
          9.934965060058191
        ],
        [
          -17.614861910840176,
          -16.424783865256245,
          9.356542048628064
        ],
        [
          -15.102385865425365,
          -19.192499459458475,
          9.727384435407386
        ],
        [
          -14.301405158961725,
          -19.159746267981372,
          8.29909572702403
        ],
        [
          -14.07769207915327,
          -17.955897447353337,
          6.205908970246763
        ],
        [
          -19.06614306431299,
          -17.105382037989926,
          9.06441605862407
        ],
        [
          -17.71568832529791,
          -15.991567746836719,
          10.795040700448421
        ],
        [
          -12.584967270785302,
          -17.40107427451263,
          6.397321365480629
        ],
        [
          -14.00148937025299,
          -19.3670397717755,
          5.408697000561405
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_0",
      "score": 0.23131276675378087,
      "energy": -5.9180278478278145,
      "binding_affinity": -9.873744664924383,
      "ic50": 57.7764613371157,
      "ic50_nm": 57.7764613371157,
      "ligand_efficiency": -0.7595188203787987,
      "rmsd": null,
      "confidence": 0.7686872332462191,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2793228077466036,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.305701860373535,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.87905874278884,
          -16.86189177836742,
          9.592607691622138
        ],
        [
          -16.021279345378666,
          -17.433926354556338,
          8.576875993500654
        ],
        [
          -16.485974791938627,
          -17.50334096162283,
          7.225906507452262
        ],
        [
          -14.858367164314117,
          -17.82360528543032,
          8.98706151408475
        ],
        [
          -15.654267148976528,
          -18.23404042233355,
          6.341289247073135
        ],
        [
          -17.87429977137531,
          -17.126515166381242,
          6.896146952269948
        ],
        [
          -14.434756137170883,
          -18.696234540422974,
          6.761475014875817
        ],
        [
          -14.030677163048205,
          -18.59428361050797,
          7.898687448923759
        ],
        [
          -14.39519393724401,
          -17.75980667619312,
          10.335657979072195
        ],
        [
          -17.738662537407563,
          -15.681870352290776,
          6.226456834785804
        ],
        [
          -18.523605322940345,
          -18.1669075978443,
          5.969875803949467
        ],
        [
          -14.302022823798605,
          -19.100654158433148,
          11.142374615104384
        ],
        [
          -12.901835113618294,
          -17.116923095616055,
          10.385584397285662
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_5",
      "score": 0.27470800607419443,
      "energy": -6.0663328311313185,
      "binding_affinity": -9.005839878516111,
      "ic50": 250.03163430827152,
      "ic50_nm": 250.03163430827152,
      "ligand_efficiency": -0.6927569137320085,
      "rmsd": null,
      "confidence": 0.7252919939258056,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2795573756209846,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3082612150392534,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.947600354191994,
          -17.71586739594377,
          9.74132867898043
        ],
        [
          -16.070668577150236,
          -17.66959214699246,
          8.644717256586581
        ],
        [
          -16.292400232883853,
          -18.456670644003243,
          7.438343801060373
        ],
        [
          -14.989971898571874,
          -16.92050407544939,
          8.588320941873356
        ],
        [
          -15.419118120481507,
          -18.482302900012105,
          6.466376007204133
        ],
        [
          -17.672564747003516,
          -19.423371154237554,
          7.402455473244338
        ],
        [
          -14.258962680830237,
          -17.68354333261639,
          6.5106378768211535
        ],
        [
          -14.030730679902511,
          -16.903975531688996,
          7.667073282119176
        ],
        [
          -14.686763557525609,
          -16.12011729010495,
          9.96968591355338
        ],
        [
          -18.649908426362263,
          -18.58800118602009,
          6.652682113504817
        ],
        [
          -17.174515321542717,
          -20.65329815369005,
          6.917542874811705
        ],
        [
          -13.601420435067713,
          -16.7611377462221,
          10.82821665925567
        ],
        [
          -14.305374968485967,
          -14.721618443018933,
          9.512619120984866
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_20",
      "score": 0.28204772674036693,
      "energy": -6.843125542239402,
      "binding_affinity": -8.859045465192661,
      "ic50": 320.3369766635056,
      "ic50_nm": 320.3369766635056,
      "ligand_efficiency": -0.6814650357840508,
      "rmsd": null,
      "confidence": 0.7179522732596331,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28699915622767225,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3064519292440682,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -13.776273226516267,
          -18.175050125923946,
          8.081376461989871
        ],
        [
          -15.176101946614407,
          -17.877416176284978,
          8.113208991776498
        ],
        [
          -15.643136002763868,
          -16.91402277984056,
          9.075700455464757
        ],
        [
          -15.97246650535446,
          -18.55512108574463,
          7.370146270019821
        ],
        [
          -16.921743011415302,
          -16.436593563229266,
          9.035173866207497
        ],
        [
          -14.565680352424124,
          -16.10215900816677,
          9.910632004851248
        ],
        [
          -17.723314177321264,
          -17.15888672867987,
          8.14910399296804
        ],
        [
          -17.357268517315745,
          -18.120984812837396,
          7.41612753006059
        ],
        [
          -15.565449929044341,
          -19.655910804429418,
          6.413935633067255
        ],
        [
          -14.137327058239187,
          -14.892916168817067,
          9.372888630906843
        ],
        [
          -15.150774941028873,
          -15.932853313316102,
          11.341869607908375
        ],
        [
          -16.073293657572552,
          -20.945832198992825,
          7.023790407813056
        ],
        [
          -16.037170674389586,
          -19.33225323373717,
          5.036046146966148
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_7",
      "score": 0.28891650039589,
      "energy": -8.73245129330115,
      "binding_affinity": -8.7216699920822,
      "ic50": 403.93765913186735,
      "ic50_nm": 403.93765913186735,
      "ligand_efficiency": -0.6708976916986308,
      "rmsd": null,
      "confidence": 0.71108349960411,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2834525735296444,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3082563025317586,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.55551407333496,
          -16.190783193228565,
          9.066325618005916
        ],
        [
          -15.907440246821174,
          -17.119615610266223,
          8.418644048895453
        ],
        [
          -15.382695574883385,
          -18.22489842644051,
          9.23452566277476
        ],
        [
          -15.911751523782275,
          -17.22493979100397,
          7.080525835150598
        ],
        [
          -14.822150143163114,
          -19.41549331403354,
          8.563349454086033
        ],
        [
          -15.482327410416893,
          -18.26632617803443,
          10.723709123694132
        ],
        [
          -14.770444925320046,
          -19.394479869219598,
          7.137560826766133
        ],
        [
          -15.338071462383954,
          -18.282361815031802,
          6.512392680234962
        ],
        [
          -16.387561295661197,
          -16.209608225167806,
          6.194011085027857
        ],
        [
          -16.648025857275947,
          -19.100246609483307,
          11.232400883148834
        ],
        [
          -14.258703027630482,
          -18.760064365356413,
          11.307438108234622
        ],
        [
          -15.26579548662204,
          -15.242802019451211,
          5.70071903860665
        ],
        [
          -17.36951897270452,
          -16.668380583282634,
          5.168397635374063
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.28181038624852495,
        "min": 0.2674941503741864,
        "max": 0.2940339557287674,
        "std": 0.006950871226210824
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.304684323901427,
        "min": -1.3082612150392534,
        "max": -1.2994772041320997,
        "std": 0.0026457493886179397
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_23",
        "ml_pose_28",
        "ml_pose_3",
        "ml_pose_26",
        "ml_pose_29",
        "ml_pose_18",
        "ml_pose_0",
        "ml_pose_5",
        "ml_pose_20",
        "ml_pose_7"
      ],
      "total_energy": [
        -6.465031166592185,
        -6.786231347594527,
        -5.756094320263864,
        -6.143356544376279,
        -5.281253224255214,
        -7.26350380766302,
        -5.9180278478278145,
        -6.0663328311313185,
        -6.843125542239402,
        -8.73245129330115
      ],
      "vdw": [
        0.2779414112922622,
        0.2773865341497368,
        0.2940339557287674,
        0.2828799914433865,
        0.2890359063720057,
        0.2674941503741864,
        0.2793228077466036,
        0.2795573756209846,
        0.28699915622767225,
        0.2834525735296444
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3039167761864812,
        -1.2994772041320997,
        -1.3053799469436103,
        -1.3045886448003021,
        -1.3033258427874848,
        -1.3014835169756773,
        -1.305701860373535,
        -1.3082612150392534,
        -1.3064519292440682,
        -1.3082563025317586
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -11.878026486714289,
      -10.800001403778563,
      -10.38877568329346,
      -10.189942032700529,
      -10.179998526334913,
      -10.046446112681188,
      -9.873744664924383,
      -9.005839878516111,
      -8.859045465192661,
      -8.7216699920822
    ],
    "ic50_distribution": [
      1.9608805718161195,
      12.09846418817695,
      24.220983537032833,
      33.880735847361365,
      34.4542042610943,
      43.166504877926386,
      57.7764613371157,
      250.03163430827152,
      320.3369766635056,
      403.93765913186735
    ],
    "ligand_efficiency_distribution": [
      -0.9136943451318683,
      -0.8307693387521972,
      -0.7991365910225738,
      -0.7838416948231176,
      -0.7830768097180703,
      -0.7728035471293222,
      -0.7595188203787987,
      -0.6927569137320085,
      -0.6814650357840508,
      -0.6708976916986308
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 2.9608805718161193,
        "delta_g": -11.878026486714289,
        "ligand_efficiency": -0.9136943451318683,
        "lipophilic_efficiency": 6.028579109681713,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 13.09846418817695,
        "delta_g": -10.800001403778563,
        "ligand_efficiency": -0.8307693387521972,
        "lipophilic_efficiency": 5.3827796229474005,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 25.22098353703283,
        "delta_g": -10.38877568329346,
        "ligand_efficiency": -0.7991365910225738,
        "lipophilic_efficiency": 5.098237981348292,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "excellent",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 34.88073584736137,
        "delta_g": -10.189942032700529,
        "ligand_efficiency": -0.7838416948231176,
        "lipophilic_efficiency": 4.95741436172463,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 35.45420426109429,
        "delta_g": -10.179998526334913,
        "ligand_efficiency": -0.7830768097180703,
        "lipophilic_efficiency": 4.950332257543539,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 44.166504877926386,
        "delta_g": -10.046446112681188,
        "ligand_efficiency": -0.7728035471293222,
        "lipophilic_efficiency": 4.854906967331798,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 58.77646133711569,
        "delta_g": -9.873744664924383,
        "ligand_efficiency": -0.7595188203787987,
        "lipophilic_efficiency": 4.730796564367958,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 251.03163430827155,
        "delta_g": -9.005839878516111,
        "ligand_efficiency": -0.6927569137320085,
        "lipophilic_efficiency": 4.1002715464877495,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 321.3369766635056,
        "delta_g": -8.859045465192661,
        "ligand_efficiency": -0.6814650357840508,
        "lipophilic_efficiency": 3.993039296742497,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 404.9376591318673,
        "delta_g": -8.7216699920822,
        "ligand_efficiency": -0.6708976916986308,
        "lipophilic_efficiency": 3.8926118320420917,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.54355515022687,
        "length": 5.60408081174063,
        "width": 2.626824183302034,
        "height": 5.615627042083224
      },
      {
        "radius_of_gyration": 2.56212166268647,
        "length": 6.884082869856236,
        "width": 3.6627903643458417,
        "height": 3.9165031927003398
      },
      {
        "radius_of_gyration": 2.5047857990039217,
        "length": 3.735444378153513,
        "width": 6.35658978383881,
        "height": 3.05220625642146
      },
      {
        "radius_of_gyration": 2.537100049446786,
        "length": 4.352866599121867,
        "width": 5.717586614692793,
        "height": 4.722821085976666
      },
      {
        "radius_of_gyration": 2.5301204605052123,
        "length": 5.551305032963402,
        "width": 5.359592997017824,
        "height": 2.9929407679888698
      },
      {
        "radius_of_gyration": 2.5729058133945517,
        "length": 6.481175793527687,
        "width": 3.37547202493878,
        "height": 5.386343699887016
      },
      {
        "radius_of_gyration": 2.5298990531962375,
        "length": 5.621770209322051,
        "width": 3.418783806142372,
        "height": 5.172498811154917
      },
      {
        "radius_of_gyration": 2.521745802378435,
        "length": 5.04848799129455,
        "width": 5.931679710671116,
        "height": 4.361840652051537
      },
      {
        "radius_of_gyration": 2.5189157678875405,
        "length": 3.947040950804997,
        "width": 6.0529160301757585,
        "height": 6.305823460942227
      },
      {
        "radius_of_gyration": 2.527737230463852,
        "length": 3.1108159450740374,
        "width": 4.172691294582329,
        "height": 6.139040472860559
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        0.13109867566428557,
        -6.465031166592185
      ],
      [
        0.18499992981107183,
        -6.786231347594527
      ],
      [
        0.20556121583532705,
        -5.756094320263864
      ],
      [
        0.2155028983649736,
        -6.143356544376279
      ],
      [
        0.21600007368325436,
        -5.281253224255214
      ],
      [
        0.22267769436594054,
        -7.26350380766302
      ],
      [
        0.23131276675378087,
        -5.9180278478278145
      ],
      [
        0.27470800607419443,
        -6.0663328311313185
      ],
      [
        0.28204772674036693,
        -6.843125542239402
      ],
      [
        0.28891650039589,
        -8.73245129330115
      ]
    ],
    "score_vs_interactions": [
      [
        0.13109867566428557,
        0
      ],
      [
        0.18499992981107183,
        0
      ],
      [
        0.20556121583532705,
        0
      ],
      [
        0.2155028983649736,
        0
      ],
      [
        0.21600007368325436,
        0
      ],
      [
        0.22267769436594054,
        0
      ],
      [
        0.23131276675378087,
        0
      ],
      [
        0.27470800607419443,
        0
      ],
      [
        0.28204772674036693,
        0
      ],
      [
        0.28891650039589,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -6.465031166592185,
        0
      ],
      [
        -6.786231347594527,
        0
      ],
      [
        -5.756094320263864,
        0
      ],
      [
        -6.143356544376279,
        0
      ],
      [
        -5.281253224255214,
        0
      ],
      [
        -7.26350380766302,
        0
      ],
      [
        -5.9180278478278145,
        0
      ],
      [
        -6.0663328311313185,
        0
      ],
      [
        -6.843125542239402,
        0
      ],
      [
        -8.73245129330115,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -11.878026486714289,
        -0.9136943451318683
      ],
      [
        -10.800001403778563,
        -0.8307693387521972
      ],
      [
        -10.38877568329346,
        -0.7991365910225738
      ],
      [
        -10.189942032700529,
        -0.7838416948231176
      ],
      [
        -10.179998526334913,
        -0.7830768097180703
      ],
      [
        -10.046446112681188,
        -0.7728035471293222
      ],
      [
        -9.873744664924383,
        -0.7595188203787987
      ],
      [
        -9.005839878516111,
        -0.6927569137320085
      ],
      [
        -8.859045465192661,
        -0.6814650357840508
      ],
      [
        -8.7216699920822,
        -0.6708976916986308
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        
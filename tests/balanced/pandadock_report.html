
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-11T07:15:35.697117 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-11T07:15:35.697117",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": [
      "ASN265"
    ]
  },
  "summary": {
    "total_poses": 10,
    "best_score": -2.7315680882556785,
    "worst_score": -1.6864247185623995,
    "mean_score": -2.0607347066748867,
    "score_range": 1.045143369693279,
    "best_energy": -8.639671308984793,
    "worst_energy": -5.217803610324797,
    "mean_energy": -6.322382894633731,
    "energy_range": 3.4218676986599963,
    "best_binding_affinity": -6.0,
    "mean_binding_affinity": -6.0,
    "best_ic50": 39950.0542633965,
    "mean_ic50": 39950.054263396494
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_4",
      "score": -2.7315680882556785,
      "energy": -7.1423404953366045,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.8397757445640774,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2873470087063056,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3117227968287724,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.596629035452978,
          -16.20182998398663,
          9.16048856614563
        ],
        [
          -15.97696972792733,
          -17.293041953484764,
          8.511029791512696
        ],
        [
          -15.960691774718546,
          -17.29227905540368,
          7.017718438538539
        ],
        [
          -15.347019948317925,
          -18.248935796660366,
          9.18615126681512
        ],
        [
          -15.234138314023092,
          -18.351908224103045,
          6.4133745932794035
        ],
        [
          -16.580210825013886,
          -16.2543022596977,
          6.3423340079071675
        ],
        [
          -14.647196903050235,
          -19.34446361826642,
          7.084374688247756
        ],
        [
          -14.89326112033362,
          -19.322348653121967,
          8.514015115988613
        ],
        [
          -15.569271232767242,
          -18.283105288133147,
          10.727813771196484
        ],
        [
          -15.393758055369487,
          -15.142994374981896,
          5.864176499606851
        ],
        [
          -17.159043918188033,
          -16.647991370129336,
          5.101940976177252
        ],
        [
          -16.52517179436788,
          -19.259893025047173,
          11.13425033694246
        ],
        [
          -14.216637350469727,
          -18.456906396983793,
          11.282331947642003
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_12",
      "score": -2.6845482948626858,
      "energy": -8.639671308984793,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.6997643391261643,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28121589968008864,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3010197258894565,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.847327621671372,
          -16.109903964606055,
          8.35764853252473
        ],
        [
          -15.964449735485477,
          -17.17153154296933,
          8.131551382778781
        ],
        [
          -14.680897200219178,
          -17.093197965571072,
          8.275980764081739
        ],
        [
          -16.619835072217917,
          -18.466987524514526,
          8.080495773841674
        ],
        [
          -13.892162491721063,
          -18.272196626120696,
          8.133185340790618
        ],
        [
          -14.086872198667674,
          -15.638026721483381,
          8.462593117699086
        ],
        [
          -14.353889610281886,
          -19.452226788932105,
          8.023857900198545
        ],
        [
          -15.867334489479582,
          -19.5082379900923,
          7.923674312259712
        ],
        [
          -18.097488934093118,
          -18.655659297854974,
          7.935616548640854
        ],
        [
          -13.546492000360136,
          -15.472233212217883,
          10.014452580579402
        ],
        [
          -12.790920655925426,
          -15.68183168348305,
          7.5947137251755015
        ],
        [
          -18.709578281292412,
          -18.861777275531725,
          6.547267466742268
        ],
        [
          -18.642751708584786,
          -19.716189406622917,
          8.8589625546871
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_25",
      "score": -2.1818745628655387,
      "energy": -5.690280276137458,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.6542446155573147,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.282113625574619,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3059528350410818,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.6956605964615,
          -16.53378429866934,
          9.43006440152395
        ],
        [
          -16.064086099324953,
          -17.321145178033046,
          8.591289308376425
        ],
        [
          -16.147043170349637,
          -17.197317388764468,
          7.267567017352003
        ],
        [
          -15.060921711980598,
          -18.26186175615991,
          8.94967933146056
        ],
        [
          -15.487789998405653,
          -18.10703216825845,
          6.343293812408447
        ],
        [
          -17.214560354069057,
          -16.171951431075165,
          6.629457211442675
        ],
        [
          -14.715558283702293,
          -19.015000449147536,
          6.908275313931579
        ],
        [
          -14.371920266515566,
          -19.1736088980827,
          8.097084939759675
        ],
        [
          -14.878275617086256,
          -18.41942704670622,
          10.526015300205128
        ],
        [
          -16.389358057222548,
          -14.956602012809759,
          6.227422182518631
        ],
        [
          -18.040284605795815,
          -16.69547265932062,
          5.531969652849524
        ],
        [
          -15.641783585381756,
          -19.71075338179962,
          11.038729474687376
        ],
        [
          -13.392757653704333,
          -18.536043331173158,
          10.799152053484033
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_17",
      "score": -2.1657677618669067,
      "energy": -6.522489009767362,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.5845866476941368,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.3001494306659509,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3008220828619002,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.376810718348384,
          -17.06580841145601,
          7.425126582832156
        ],
        [
          -16.101855464014683,
          -17.531215806282916,
          8.02272663553768
        ],
        [
          -15.716356543422318,
          -18.74224956484589,
          7.5660020321545325
        ],
        [
          -15.534213249870543,
          -16.730386473134807,
          8.910062835053644
        ],
        [
          -14.4599479204571,
          -19.1316666917234,
          8.103365028896558
        ],
        [
          -16.47820189051585,
          -19.48110877220243,
          6.619705186398012
        ],
        [
          -13.869328427824389,
          -18.451892394754232,
          8.95042743080506
        ],
        [
          -14.325449478588805,
          -17.242607606681744,
          9.350684697813904
        ],
        [
          -16.09303721323387,
          -15.469754019276674,
          9.294063031591818
        ],
        [
          -15.90183279815625,
          -19.366646999165507,
          5.143760036333312
        ],
        [
          -16.453602117894235,
          -21.05226336838984,
          6.839672446107966
        ],
        [
          -16.667819464344635,
          -15.476565137228746,
          10.838346316060715
        ],
        [
          -15.121544713328952,
          -14.357834754857798,
          9.276057740414643
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_7",
      "score": -2.140939384797258,
      "energy": -6.284825204189024,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.6034988168868018,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2850877732103129,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3040707146971247,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.355208349719371,
          -19.164870470197986,
          6.898548516529245
        ],
        [
          -15.580110142614279,
          -18.089498018279105,
          7.802983807314426
        ],
        [
          -16.271741923888634,
          -16.96478879773193,
          7.486101009453225
        ],
        [
          -15.099739177608935,
          -18.355518009870824,
          8.981890275455072
        ],
        [
          -16.520127602132032,
          -15.938624931946375,
          8.399479115162883
        ],
        [
          -16.8713339216418,
          -16.82200623995479,
          5.9760842669522605
        ],
        [
          -16.03506148855407,
          -16.128321376937645,
          9.636551487799736
        ],
        [
          -15.274867961157803,
          -17.24019370112189,
          9.946513871930094
        ],
        [
          -14.382980392634726,
          -19.494937422288405,
          9.458290684432141
        ],
        [
          -18.31576152263078,
          -17.155382034983198,
          5.881589073421182
        ],
        [
          -16.56324901690834,
          -15.434669881567132,
          5.507002713751966
        ],
        [
          -12.895085113806587,
          -19.239816416858393,
          9.59802381274167
        ],
        [
          -14.934733386702629,
          -20.071372698262348,
          10.766941365056102
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_11",
      "score": -1.813320963203695,
      "energy": -5.790349109708224,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.8069872390827462,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27710715238945066,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3083742435675425,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.31054831125833,
          -18.4567285120378,
          6.430257594654083
        ],
        [
          -15.884367814042758,
          -17.893762894352868,
          7.71555180522866
        ],
        [
          -16.704207072213936,
          -18.179393533570167,
          8.84393073103686
        ],
        [
          -14.688593294195925,
          -17.071387901385908,
          7.665787931060851
        ],
        [
          -16.06936220187651,
          -17.667797033248238,
          10.120972430256987
        ],
        [
          -17.898763166168845,
          -18.996153281801522,
          8.754283345432889
        ],
        [
          -15.018299326040271,
          -16.878538220993065,
          9.92985652412311
        ],
        [
          -14.243639409077701,
          -16.62901460149763,
          8.870523291610162
        ],
        [
          -13.981113218339368,
          -16.898487047481677,
          6.344620639410067
        ],
        [
          -17.598769810265004,
          -20.46379274223126,
          9.267820613954509
        ],
        [
          -18.919549295858033,
          -18.317863801597557,
          9.74004158127764
        ],
        [
          -14.247239219989728,
          -15.383520166980123,
          6.013080928648545
        ],
        [
          -12.535547860673596,
          -17.263560262822207,
          6.6432725833055954
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_22",
      "score": -1.7830794010485937,
      "energy": -5.558825338084846,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.6488630235105037,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2734237292545343,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3016049152581808,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.463267318521417,
          -19.139491409540703,
          7.368755929842296
        ],
        [
          -15.30657790000856,
          -18.10631159852257,
          7.934219813457272
        ],
        [
          -15.335131490287988,
          -17.834683920405766,
          9.242421199375574
        ],
        [
          -16.1904497706744,
          -17.385722374260293,
          7.186911473803541
        ],
        [
          -16.163957345562366,
          -16.873145344784586,
          9.905159903156328
        ],
        [
          -14.551494612136352,
          -18.683235236074793,
          10.272901048660643
        ],
        [
          -17.104661873924552,
          -16.294455833637414,
          9.060607633482206
        ],
        [
          -17.05623241069184,
          -16.471270684982873,
          7.715145009944811
        ],
        [
          -16.10811064038393,
          -17.527260412467637,
          5.630092900606272
        ],
        [
          -13.177191118314184,
          -17.922013987693255,
          10.710826624436276
        ],
        [
          -15.267854435530644,
          -19.16618246373289,
          11.4116922533733
        ],
        [
          -17.425628600959527,
          -18.38882010367006,
          5.053272617133793
        ],
        [
          -15.949442483004223,
          -16.307406630227153,
          4.847993592727706
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_13",
      "score": -1.717003566375274,
      "energy": -5.217803610324797,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.8730257073784509,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2879350030780109,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3024536936372035,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.408961869464317,
          -17.26784266555478,
          9.131941033382258
        ],
        [
          -16.21809177842205,
          -17.680193613843272,
          8.461780882264474
        ],
        [
          -15.843894147809852,
          -17.008660512537094,
          7.192244325260733
        ],
        [
          -15.297422507581278,
          -18.4491890278329,
          8.97456942478101
        ],
        [
          -14.709287730160021,
          -17.29057084787548,
          6.578954681197546
        ],
        [
          -16.930434892037034,
          -15.957540788840925,
          6.623420799309791
        ],
        [
          -13.946142709382109,
          -18.104229290383188,
          7.254746912970107
        ],
        [
          -14.166584383554454,
          -18.715745937251732,
          8.254195298099443
        ],
        [
          -15.576293611258446,
          -19.20004365517677,
          10.390381688156715
        ],
        [
          -16.552410059569112,
          -14.615739283371028,
          6.833797890990105
        ],
        [
          -17.10605481779035,
          -16.359748994460077,
          5.03877798561834
        ],
        [
          -15.890239733007505,
          -20.534740536645288,
          10.248872692672263
        ],
        [
          -14.454181759963461,
          -18.91575484622743,
          11.356316385297216
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_24",
      "score": -1.7028203249108333,
      "energy": -7.07142648691982,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.5467339440174025,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2919467060246315,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3047756855266124,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.565166419717333,
          -15.758969667069223,
          7.824926536552134
        ],
        [
          -15.700118203440294,
          -17.1954274509623,
          8.05181793318038
        ],
        [
          -16.806788785681555,
          -17.651283812995022,
          8.670752742168212
        ],
        [
          -14.549102851081889,
          -17.99232984642753,
          7.696120756720511
        ],
        [
          -16.876282407704885,
          -18.919569375838055,
          8.97882373304185
        ],
        [
          -17.833881204211174,
          -16.69795785492795,
          9.29578739182369
        ],
        [
          -15.880123605182824,
          -19.790142664876498,
          8.558674198548605
        ],
        [
          -14.701792243477408,
          -19.30859753076013,
          7.844157365783808
        ],
        [
          -13.460005656004089,
          -17.526660608696673,
          6.936002101422435
        ],
        [
          -19.06223741299746,
          -16.630591031362915,
          8.377557127203058
        ],
        [
          -18.224493608599047,
          -16.903408996416438,
          10.693372817118231
        ],
        [
          -12.184396921871809,
          -17.572504740923076,
          7.725906374235919
        ],
        [
          -13.255610680030218,
          -18.152556418744165,
          5.68610092220116
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_23",
      "score": -1.6864247185623995,
      "energy": -5.305818106884372,
      "binding_affinity": -6.0,
      "ic50": 39950.0542633965,
      "ic50_nm": 39950.0542633965,
      "ligand_efficiency": -0.46153846153846156,
      "rmsd": null,
      "confidence": 0.8987304795825815,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2713291980116011,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3094994757846152,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.449089454525136,
          -15.849567558968019,
          7.822050896049868
        ],
        [
          -15.970128801792656,
          -17.069806907611735,
          8.051486573783407
        ],
        [
          -16.088121543041964,
          -17.74724109293157,
          9.286424746686173
        ],
        [
          -15.251237522836224,
          -17.892286387875075,
          7.131260170834803
        ],
        [
          -15.482839840809355,
          -19.09373141571647,
          9.556239124701094
        ],
        [
          -17.01558900906857,
          -17.090511839749503,
          10.382678728459354
        ],
        [
          -14.846602903606446,
          -19.624406596535945,
          8.673424995584563
        ],
        [
          -14.583414637737121,
          -19.055048817807425,
          7.336486800713763
        ],
        [
          -14.89755408970139,
          -17.110945792800177,
          5.7779081686598985
        ],
        [
          -18.33545268308937,
          -17.544717654838752,
          10.44278574243855
        ],
        [
          -16.18445996999039,
          -17.188814738111486,
          11.672290011227782
        ],
        [
          -13.625508340689668,
          -16.62715029198321,
          5.630045078853675
        ],
        [
          -15.370001203111705,
          -18.205770905070572,
          4.5769189620070545
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.2837655526595505,
        "min": 0.2713291980116011,
        "max": 0.3001494306659509,
        "std": 0.00826136947569755
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.3050296169092492,
        "min": -1.3117227968287724,
        "max": -1.3008220828619002,
        "std": 0.0036048253834981446
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_4",
        "ml_pose_12",
        "ml_pose_25",
        "ml_pose_17",
        "ml_pose_7",
        "ml_pose_11",
        "ml_pose_22",
        "ml_pose_13",
        "ml_pose_24",
        "ml_pose_23"
      ],
      "total_energy": [
        -7.1423404953366045,
        -8.639671308984793,
        -5.690280276137458,
        -6.522489009767362,
        -6.284825204189024,
        -5.790349109708224,
        -5.558825338084846,
        -5.217803610324797,
        -7.07142648691982,
        -5.305818106884372
      ],
      "vdw": [
        0.2873470087063056,
        0.28121589968008864,
        0.282113625574619,
        0.3001494306659509,
        0.2850877732103129,
        0.27710715238945066,
        0.2734237292545343,
        0.2879350030780109,
        0.2919467060246315,
        0.2713291980116011
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3117227968287724,
        -1.3010197258894565,
        -1.3059528350410818,
        -1.3008220828619002,
        -1.3040707146971247,
        -1.3083742435675425,
        -1.3016049152581808,
        -1.3024536936372035,
        -1.3047756855266124,
        -1.3094994757846152
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0,
      -6.0
    ],
    "ic50_distribution": [
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965,
      39950.0542633965
    ],
    "ligand_efficiency_distribution": [
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156,
      -0.46153846153846156
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 39951.054263396494,
        "delta_g": -6.0,
        "ligand_efficiency": -0.46153846153846156,
        "lipophilic_efficiency": 1.8984717556557644,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.505231287013193,
        "length": 2.942406567718306,
        "width": 4.201469243284524,
        "height": 6.180390971464751
      },
      {
        "radius_of_gyration": 2.552733699738438,
        "length": 5.918657625366986,
        "width": 4.243956194405033,
        "height": 3.467185113837134
      },
      {
        "radius_of_gyration": 2.5259537475626543,
        "length": 4.647526952091482,
        "width": 4.754151368989861,
        "height": 5.506759821837852
      },
      {
        "radius_of_gyration": 2.5177790651699947,
        "length": 3.5074822905239955,
        "width": 6.694428613532043,
        "height": 5.694586279727403
      },
      {
        "radius_of_gyration": 2.530149000662948,
        "length": 5.4206764088241925,
        "width": 4.636702816695216,
        "height": 5.259938651304136
      },
      {
        "radius_of_gyration": 2.536852810922441,
        "length": 6.384001435184437,
        "width": 5.080272575251136,
        "height": 4.107891501608442
      },
      {
        "radius_of_gyration": 2.5526187959413447,
        "length": 4.248437482645343,
        "width": 2.871726630095477,
        "height": 6.563698660645594
      },
      {
        "radius_of_gyration": 2.537033098707265,
        "length": 3.4628191600822085,
        "width": 5.91900125327426,
        "height": 6.317538399678876
      },
      {
        "radius_of_gyration": 2.5303787540640434,
        "length": 6.877840491125653,
        "width": 4.031172997807275,
        "height": 5.007271894917071
      },
      {
        "radius_of_gyration": 2.533911091432801,
        "length": 4.7099443423997,
        "width": 3.7748390375679257,
        "height": 7.095371049220727
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        -2.7315680882556785,
        -7.1423404953366045
      ],
      [
        -2.6845482948626858,
        -8.639671308984793
      ],
      [
        -2.1818745628655387,
        -5.690280276137458
      ],
      [
        -2.1657677618669067,
        -6.522489009767362
      ],
      [
        -2.140939384797258,
        -6.284825204189024
      ],
      [
        -1.813320963203695,
        -5.790349109708224
      ],
      [
        -1.7830794010485937,
        -5.558825338084846
      ],
      [
        -1.717003566375274,
        -5.217803610324797
      ],
      [
        -1.7028203249108333,
        -7.07142648691982
      ],
      [
        -1.6864247185623995,
        -5.305818106884372
      ]
    ],
    "score_vs_interactions": [
      [
        -2.7315680882556785,
        0
      ],
      [
        -2.6845482948626858,
        0
      ],
      [
        -2.1818745628655387,
        0
      ],
      [
        -2.1657677618669067,
        0
      ],
      [
        -2.140939384797258,
        0
      ],
      [
        -1.813320963203695,
        0
      ],
      [
        -1.7830794010485937,
        0
      ],
      [
        -1.717003566375274,
        0
      ],
      [
        -1.7028203249108333,
        0
      ],
      [
        -1.6864247185623995,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -7.1423404953366045,
        0
      ],
      [
        -8.639671308984793,
        0
      ],
      [
        -5.690280276137458,
        0
      ],
      [
        -6.522489009767362,
        0
      ],
      [
        -6.284825204189024,
        0
      ],
      [
        -5.790349109708224,
        0
      ],
      [
        -5.558825338084846,
        0
      ],
      [
        -5.217803610324797,
        0
      ],
      [
        -7.07142648691982,
        0
      ],
      [
        -5.305818106884372,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ],
      [
        -6.0,
        -0.46153846153846156
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        
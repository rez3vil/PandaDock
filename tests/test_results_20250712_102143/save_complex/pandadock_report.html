
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-12T10:23:31.470392 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-12T10:23:31.470392",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": []
  },
  "summary": {
    "total_poses": 10,
    "best_score": 0.11126361788734629,
    "worst_score": 0.29486155034768236,
    "mean_score": 0.18472474583568785,
    "score_range": 0.18359793246033607,
    "best_energy": -8.485457630849464,
    "worst_energy": -5.228864111155101,
    "mean_energy": -6.604128624751999,
    "energy_range": 3.2565935196943627,
    "best_binding_affinity": -8.625414682317242,
    "mean_binding_affinity": -4.442277831715058,
    "best_ic50": 475.2008720713642,
    "mean_ic50": 3300901.7221470815
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_10",
      "score": 0.11126361788734629,
      "energy": -8.485457630849464,
      "binding_affinity": -8.625414682317242,
      "ic50": 475.2008720713642,
      "ic50_nm": 475.2008720713642,
      "ligand_efficiency": -0.6634934371013264,
      "rmsd": null,
      "confidence": 0.8887363821126537,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28731089988294833,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3075990425559154,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.092810496359395,
          -19.04040269043587,
          7.461310380979903
        ],
        [
          -16.121111720948704,
          -18.06672975513877,
          8.031837983480866
        ],
        [
          -15.253434891218053,
          -17.45397450849875,
          7.056479182111719
        ],
        [
          -16.008613571928727,
          -17.88512346937728,
          9.218383601270588
        ],
        [
          -14.229665701049019,
          -16.68463307144929,
          7.53799244204594
        ],
        [
          -15.254431327762893,
          -17.890656501318794,
          5.579572239920607
        ],
        [
          -14.28051358582989,
          -16.258618189760185,
          8.87654831413111
        ],
        [
          -15.122757792166203,
          -16.89136856479759,
          9.846551907052849
        ],
        [
          -17.095290516531886,
          -18.33361982883615,
          10.252689946883304
        ],
        [
          -15.91805875614279,
          -16.772407654734604,
          4.929073220510144
        ],
        [
          -13.761666186632706,
          -18.099742154065645,
          5.188323248019694
        ],
        [
          -16.328468621354084,
          -19.37075943788105,
          11.125513145874415
        ],
        [
          -17.633176832075648,
          -17.351964173706072,
          11.235724387718836
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_2",
      "score": 0.13009783587277068,
      "energy": -6.350283343179386,
      "binding_affinity": -6.645310291646169,
      "ic50": 13441.663606372475,
      "ic50_nm": 13441.663606372475,
      "ligand_efficiency": -0.511177714742013,
      "rmsd": null,
      "confidence": 0.8699021641272293,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2888779188875497,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.299557341793079,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.343654403152525,
          -15.743712762181158,
          8.228478418306253
        ],
        [
          -15.626018111908145,
          -17.166067722668743,
          8.183091406849826
        ],
        [
          -16.835442660792914,
          -17.528409656994672,
          8.069452448206892
        ],
        [
          -14.63158270374853,
          -18.02886628760122,
          8.338354058004725
        ],
        [
          -17.14181438459278,
          -18.906884308296625,
          8.122957827263964
        ],
        [
          -17.991602596228013,
          -16.614434749441617,
          8.014678685376506
        ],
        [
          -16.086003349786058,
          -19.80823869084933,
          8.148578839185404
        ],
        [
          -14.860800898145186,
          -19.415890194346325,
          8.316021369223598
        ],
        [
          -13.095352149808958,
          -17.517128965230384,
          8.353973299842078
        ],
        [
          -18.613443807560515,
          -16.456398692092645,
          6.580652846901465
        ],
        [
          -19.161451932706264,
          -17.013371635973325,
          8.867447209903471
        ],
        [
          -12.526236041856146,
          -17.687561845876342,
          9.806823319839513
        ],
        [
          -12.186596959713967,
          -18.213034488447608,
          7.309490271096315
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_19",
      "score": 0.14504479886898358,
      "energy": -6.49523232971054,
      "binding_affinity": -5.356876457598444,
      "ic50": 118298.34300134936,
      "ic50_nm": 118298.34300134936,
      "ligand_efficiency": -0.41206741981526496,
      "rmsd": null,
      "confidence": 0.8549552011310164,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2856657680162106,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3066555720903135,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.19225737916841,
          -19.58373906829083,
          7.745752744415935
        ],
        [
          -15.925715855235758,
          -18.243524283736104,
          8.042151876595558
        ],
        [
          -15.76221010277077,
          -17.335997599779112,
          7.0374912073496745
        ],
        [
          -15.48950696007692,
          -17.93651557217981,
          9.225119867019222
        ],
        [
          -15.541142695047938,
          -15.946379740591745,
          7.481078035726753
        ],
        [
          -16.231461067052752,
          -17.625198391116466,
          5.70554238373003
        ],
        [
          -15.07964475416695,
          -15.694379138601832,
          8.651338951347046
        ],
        [
          -15.074684398738242,
          -16.562150606645037,
          9.682760105771738
        ],
        [
          -15.430340385361198,
          -18.926958137979437,
          10.439030768285482
        ],
        [
          -17.728421807932765,
          -17.234873444828597,
          5.3536635368126735
        ],
        [
          -15.380541740192541,
          -17.028086721993514,
          4.669941317220033
        ],
        [
          -14.047344259516517,
          -19.399215651557977,
          10.693986412602051
        ],
        [
          -16.21672859473922,
          -18.58298164269954,
          11.612142793123809
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_25",
      "score": 0.15317871777547443,
      "energy": -6.28999738230279,
      "binding_affinity": -4.612019730812671,
      "ic50": 415928.38221222063,
      "ic50_nm": 415928.38221222063,
      "ligand_efficiency": -0.3547707485240516,
      "rmsd": null,
      "confidence": 0.8468212822245256,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28258143322197177,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.308773029264524,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.214263631727892,
          -16.50778977988913,
          8.343926919021806
        ],
        [
          -16.155962117680502,
          -17.305432346727244,
          8.246782413423917
        ],
        [
          -16.25714082112866,
          -18.72715767826955,
          8.715990232467359
        ],
        [
          -14.996962880502215,
          -16.78456245472529,
          7.653225787512652
        ],
        [
          -15.11574178198752,
          -19.526031951578034,
          8.533627493112867
        ],
        [
          -17.52735276037122,
          -19.132572899623604,
          9.313640126209467
        ],
        [
          -13.989557077971945,
          -19.04878475912116,
          8.033893219525797
        ],
        [
          -13.941230813724225,
          -17.751145075062958,
          7.672559741375656
        ],
        [
          -14.924330253782813,
          -15.417767613502996,
          7.166831921244047
        ],
        [
          -18.262759682755245,
          -20.0036316300585,
          8.32839011846447
        ],
        [
          -17.15732607769815,
          -19.960468084057876,
          10.59426494956366
        ],
        [
          -14.118818980084532,
          -14.609363525317537,
          8.041194909380586
        ],
        [
          -14.438553120585082,
          -15.325292202066116,
          5.695672168697711
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_15",
      "score": 0.160134190111888,
      "energy": -7.467009869820523,
      "binding_affinity": -4.183157154776054,
      "ic50": 857845.9827557928,
      "ic50_nm": 857845.9827557928,
      "ligand_efficiency": -0.321781319598158,
      "rmsd": null,
      "confidence": 0.839865809888112,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27798457606699856,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.304776396468875,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.21172757874294,
          -17.230353109934974,
          10.006990167007515
        ],
        [
          -15.515952790081785,
          -17.541273048227524,
          8.808017409581112
        ],
        [
          -14.660182718156996,
          -18.210649668731584,
          7.897940328479386
        ],
        [
          -16.758941898496673,
          -17.155744591155905,
          8.305587900880653
        ],
        [
          -14.994988716423906,
          -18.52180354691078,
          6.612202667027535
        ],
        [
          -13.244061762934692,
          -18.56085769112659,
          8.366954222756501
        ],
        [
          -16.285097429326044,
          -18.111065351081223,
          6.175336255512832
        ],
        [
          -17.14015168669024,
          -17.560362434270274,
          6.934593348029299
        ],
        [
          -17.783276636917563,
          -16.57047579473541,
          9.118193532302524
        ],
        [
          -13.22772688499275,
          -20.08449635953759,
          8.844302249330148
        ],
        [
          -12.17939638888901,
          -18.305317542120857,
          7.258684597683619
        ],
        [
          -17.92649725010213,
          -15.042588051348696,
          8.777813611708815
        ],
        [
          -19.17199825824529,
          -17.205012810818584,
          9.233383709700078
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_11",
      "score": 0.20754406885936105,
      "energy": -6.3491099996344005,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.792455931140639,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2818764273163472,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3060597417683866,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.262580846462402,
          -16.60188007601698,
          6.639434079453316
        ],
        [
          -15.674131140269104,
          -17.42890658670347,
          7.700677716158521
        ],
        [
          -15.22126036127133,
          -18.669761777606897,
          7.7461972472006515
        ],
        [
          -16.362998045840513,
          -16.79714466644099,
          8.81688528245858
        ],
        [
          -15.364463830509688,
          -19.509632748502984,
          8.930306713540908
        ],
        [
          -14.406860945985208,
          -19.287564187227925,
          6.585663150839735
        ],
        [
          -16.05173456752681,
          -18.839473413742787,
          9.982963219585631
        ],
        [
          -16.464432775666186,
          -17.60158007326785,
          9.880425195564893
        ],
        [
          -16.88164980241545,
          -15.453311635767362,
          8.601047948744773
        ],
        [
          -12.871580337778756,
          -19.098516643669186,
          6.8510945058057535
        ],
        [
          -14.800867502910343,
          -20.768754617684408,
          6.306552704823191
        ],
        [
          -18.33616884333451,
          -15.353887470137325,
          8.42107174674018
        ],
        [
          -16.40127100002969,
          -14.689586103231788,
          9.877680489083867
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_3",
      "score": 0.21095183398918915,
      "energy": -7.000390978743889,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7890481660108108,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2691794155484248,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3074322788851962,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.221610637575827,
          -18.877690246473335,
          6.665913262125924
        ],
        [
          -15.59806738639886,
          -18.011116070987352,
          7.634210531656394
        ],
        [
          -14.639449097666072,
          -17.020904290961845,
          8.04207701811106
        ],
        [
          -16.675407841991838,
          -18.30824152964843,
          8.471705546403896
        ],
        [
          -14.939340156206182,
          -16.194900652094613,
          9.168276904761136
        ],
        [
          -13.45502683323217,
          -16.772672244655393,
          7.217525144480296
        ],
        [
          -16.21273750004223,
          -16.31627741379986,
          9.825152446291995
        ],
        [
          -17.060157128472074,
          -17.506073967631163,
          9.591596574937451
        ],
        [
          -17.69669183363491,
          -19.38726473777759,
          8.09142203702012
        ],
        [
          -13.661192161877747,
          -15.668626301123815,
          6.230266814516829
        ],
        [
          -12.28858471363895,
          -16.505772315523917,
          8.213442862490915
        ],
        [
          -17.521619686863225,
          -20.56601086382479,
          9.16820783909611
        ],
        [
          -19.130115022399906,
          -18.964449365497853,
          8.020203018107873
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_26",
      "score": 0.21640893490218782,
      "energy": -5.3831467928314565,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7835910650978122,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27425381498068446,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.302832770820577,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.359959210222705,
          -17.057218140282863,
          6.905587654087949
        ],
        [
          -15.359509321128318,
          -17.48296831897041,
          7.743096748532762
        ],
        [
          -15.154066985754834,
          -18.78662244898546,
          8.43602501695729
        ],
        [
          -16.23950332892452,
          -16.668183713268842,
          8.090244650318018
        ],
        [
          -16.120461586463204,
          -19.218801239854425,
          9.218322254656183
        ],
        [
          -14.008822446171745,
          -19.710721405717297,
          8.106218156582209
        ],
        [
          -17.31857014947399,
          -18.432808181590993,
          9.579208972752406
        ],
        [
          -17.335339456497675,
          -17.281459742229053,
          8.98136787309599
        ],
        [
          -16.529341399230045,
          -15.253590083500054,
          7.456246447683052
        ],
        [
          -12.878857944608729,
          -19.555934191517476,
          9.167450494535778
        ],
        [
          -14.433410743456474,
          -21.09010175699954,
          7.801367325059711
        ],
        [
          -17.60862478698066,
          -15.291866801413018,
          6.326557645039835
        ],
        [
          -16.753532641087045,
          -14.269723975670562,
          8.528306760698825
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_18",
      "score": 0.21776190974199516,
      "energy": -5.228864111155101,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7822380902580048,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.26980080710132076,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3060770384424558,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.904188288469559,
          -19.553509198070063,
          8.92284014957475
        ],
        [
          -15.782051819980119,
          -18.228062576654324,
          8.447098188778181
        ],
        [
          -14.562034123716579,
          -17.808423729929423,
          7.8069225001492315
        ],
        [
          -16.817470684698204,
          -17.33590329836924,
          8.61004250511197
        ],
        [
          -14.358792224158616,
          -16.545183181789245,
          7.333365498970605
        ],
        [
          -13.407035000327692,
          -18.92566533390198,
          7.6804170033696035
        ],
        [
          -15.469987073896675,
          -15.654343287859223,
          7.364299769380551
        ],
        [
          -16.63104496863555,
          -16.061753608717904,
          7.893391618238559
        ],
        [
          -18.180193663240445,
          -17.711392740893395,
          9.089306854420538
        ],
        [
          -13.418617888704624,
          -19.536736707163165,
          6.321514413448589
        ],
        [
          -12.035114289034187,
          -18.1520554123911,
          8.020750998044315
        ],
        [
          -18.264416876732373,
          -17.15991627347085,
          10.544012636693044
        ],
        [
          -19.269053098405422,
          -17.427054650790097,
          8.306037863820057
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_20",
      "score": 0.29486155034768236,
      "energy": -6.991793809292442,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7051384496523176,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2811280642953779,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3060707307185309,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.023116039861655,
          -16.470526571371877,
          7.390246702481903
        ],
        [
          -16.10807114154332,
          -17.344046369231805,
          7.861102339234147
        ],
        [
          -14.960928011943071,
          -16.87592791188465,
          8.515306665798732
        ],
        [
          -16.31084454890383,
          -18.741416067071427,
          7.820864771104183
        ],
        [
          -14.07319358478859,
          -17.715682969144808,
          8.994955690200122
        ],
        [
          -14.742212711608296,
          -15.372093562380588,
          8.637763536382199
        ],
        [
          -14.169079184566787,
          -18.98511913026919,
          9.09047364875612
        ],
        [
          -15.360102582881847,
          -19.55598179521848,
          8.56253612223015
        ],
        [
          -17.572762697270104,
          -19.30065106913085,
          7.337812845175964
        ],
        [
          -15.079825966532479,
          -14.70278974306357,
          9.900416147131025
        ],
        [
          -13.138078854455136,
          -15.064060945784341,
          8.200460173514049
        ],
        [
          -17.3065322028912,
          -19.788976528950933,
          5.86865246331746
        ],
        [
          -18.255252472753696,
          -20.18272733649747,
          8.159408894673899
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.2798659125317834,
        "min": 0.2691794155484248,
        "max": 0.2888779188875497,
        "std": 0.006586609895585094
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.3055833942807855,
        "min": -1.308773029264524,
        "max": -1.299557341793079,
        "std": 0.0025306742302776825
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_10",
        "ml_pose_2",
        "ml_pose_19",
        "ml_pose_25",
        "ml_pose_15",
        "ml_pose_11",
        "ml_pose_3",
        "ml_pose_26",
        "ml_pose_18",
        "ml_pose_20"
      ],
      "total_energy": [
        -8.485457630849464,
        -6.350283343179386,
        -6.49523232971054,
        -6.28999738230279,
        -7.467009869820523,
        -6.3491099996344005,
        -7.000390978743889,
        -5.3831467928314565,
        -5.228864111155101,
        -6.991793809292442
      ],
      "vdw": [
        0.28731089988294833,
        0.2888779188875497,
        0.2856657680162106,
        0.28258143322197177,
        0.27798457606699856,
        0.2818764273163472,
        0.2691794155484248,
        0.27425381498068446,
        0.26980080710132076,
        0.2811280642953779
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3075990425559154,
        -1.299557341793079,
        -1.3066555720903135,
        -1.308773029264524,
        -1.304776396468875,
        -1.3060597417683866,
        -1.3074322788851962,
        -1.302832770820577,
        -1.3060770384424558,
        -1.3060707307185309
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -8.625414682317242,
      -6.645310291646169,
      -5.356876457598444,
      -4.612019730812671,
      -4.183157154776054,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0
    ],
    "ic50_distribution": [
      475.2008720713642,
      13441.663606372475,
      118298.34300134936,
      415928.38221222063,
      857845.9827557928,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601
    ],
    "ligand_efficiency_distribution": [
      -0.6634934371013264,
      -0.511177714742013,
      -0.41206741981526496,
      -0.3547707485240516,
      -0.321781319598158,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 476.2008720713642,
        "delta_g": -8.625414682317242,
        "ligand_efficiency": -0.6634934371013264,
        "lipophilic_efficiency": 3.8222098136026332,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 13442.663606372476,
        "delta_g": -6.645310291646169,
        "ligand_efficiency": -0.511177714742013,
        "lipophilic_efficiency": 2.3715146691590165,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 118299.34300134936,
        "delta_g": -5.356876457598444,
        "ligand_efficiency": -0.41206741981526496,
        "lipophilic_efficiency": 1.4270176673051287,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 415929.38221222063,
        "delta_g": -4.612019730812671,
        "ligand_efficiency": -0.3547707485240516,
        "lipophilic_efficiency": 0.8809803989860976,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "poor",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 857846.9827557928,
        "delta_g": -4.183157154776054,
        "ligand_efficiency": -0.321781319598158,
        "lipophilic_efficiency": 0.566590171908067,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "poor",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.5162142830387286,
        "length": 3.8715106454429424,
        "width": 3.1121412481208637,
        "height": 6.306651167208692
      },
      {
        "radius_of_gyration": 2.535302247547628,
        "length": 6.974854972992297,
        "width": 4.064525928668171,
        "height": 3.2261704729380476
      },
      {
        "radius_of_gyration": 2.514447206726107,
        "length": 3.6810775484162477,
        "width": 3.8893599296889967,
        "height": 6.942201475903776
      },
      {
        "radius_of_gyration": 2.5304000285883146,
        "length": 4.32152886903102,
        "width": 5.394268104740963,
        "height": 4.8985927808659495
      },
      {
        "radius_of_gyration": 2.539669339866699,
        "length": 6.992601869356278,
        "width": 5.0419083081888925,
        "height": 3.8316539114946835
      },
      {
        "radius_of_gyration": 2.5262073212124982,
        "length": 5.464588505555753,
        "width": 6.07916851445262,
        "height": 3.6764105147624404
      },
      {
        "radius_of_gyration": 2.551411161429291,
        "length": 6.841530308760955,
        "width": 4.897384562700974,
        "height": 3.594885631775165
      },
      {
        "radius_of_gyration": 2.5549659857079954,
        "length": 4.72976684237193,
        "width": 6.820377781328979,
        "height": 3.252651327712571
      },
      {
        "radius_of_gyration": 2.5532689406148807,
        "length": 7.233938809371235,
        "width": 3.89916591021084,
        "height": 4.222498223244455
      },
      {
        "radius_of_gyration": 2.5297020153287324,
        "length": 5.11717361829856,
        "width": 5.479937593433901,
        "height": 4.0317636838135655
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        0.11126361788734629,
        -8.485457630849464
      ],
      [
        0.13009783587277068,
        -6.350283343179386
      ],
      [
        0.14504479886898358,
        -6.49523232971054
      ],
      [
        0.15317871777547443,
        -6.28999738230279
      ],
      [
        0.160134190111888,
        -7.467009869820523
      ],
      [
        0.20754406885936105,
        -6.3491099996344005
      ],
      [
        0.21095183398918915,
        -7.000390978743889
      ],
      [
        0.21640893490218782,
        -5.3831467928314565
      ],
      [
        0.21776190974199516,
        -5.228864111155101
      ],
      [
        0.29486155034768236,
        -6.991793809292442
      ]
    ],
    "score_vs_interactions": [
      [
        0.11126361788734629,
        0
      ],
      [
        0.13009783587277068,
        0
      ],
      [
        0.14504479886898358,
        0
      ],
      [
        0.15317871777547443,
        0
      ],
      [
        0.160134190111888,
        0
      ],
      [
        0.20754406885936105,
        0
      ],
      [
        0.21095183398918915,
        0
      ],
      [
        0.21640893490218782,
        0
      ],
      [
        0.21776190974199516,
        0
      ],
      [
        0.29486155034768236,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -8.485457630849464,
        0
      ],
      [
        -6.350283343179386,
        0
      ],
      [
        -6.49523232971054,
        0
      ],
      [
        -6.28999738230279,
        0
      ],
      [
        -7.467009869820523,
        0
      ],
      [
        -6.3491099996344005,
        0
      ],
      [
        -7.000390978743889,
        0
      ],
      [
        -5.3831467928314565,
        0
      ],
      [
        -5.228864111155101,
        0
      ],
      [
        -6.991793809292442,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -8.625414682317242,
        -0.6634934371013264
      ],
      [
        -6.645310291646169,
        -0.511177714742013
      ],
      [
        -5.356876457598444,
        -0.41206741981526496
      ],
      [
        -4.612019730812671,
        -0.3547707485240516
      ],
      [
        -4.183157154776054,
        -0.321781319598158
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-12T10:23:33.182896 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-12T10:23:33.182896",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": []
  },
  "summary": {
    "total_poses": 10,
    "best_score": 0.12863353044627823,
    "worst_score": 0.2942668291853444,
    "mean_score": 0.20378873956781027,
    "score_range": 0.16563329873906618,
    "best_energy": -7.299623682870583,
    "worst_energy": -5.436854186377945,
    "mean_energy": -6.562908209963877,
    "energy_range": 1.8627694964926373,
    "best_binding_affinity": -6.876421321522381,
    "mean_binding_affinity": -3.8033972502366185,
    "best_ic50": 9099.762289449476,
    "mean_ic50": 4630001.7437874
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_4",
      "score": 0.12863353044627823,
      "energy": -7.017850944274077,
      "binding_affinity": -6.876421321522381,
      "ic50": 9099.762289449476,
      "ic50_nm": 9099.762289449476,
      "ligand_efficiency": -0.5289554862709523,
      "rmsd": null,
      "confidence": 0.8713664695537218,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2873620449444607,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3022004487938972,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.224563551333405,
          -17.983304850030137,
          10.036789031313344
        ],
        [
          -15.562469138044513,
          -17.778115128648363,
          8.692805258449688
        ],
        [
          -16.79971185222989,
          -17.213542877471284,
          8.422971757041193
        ],
        [
          -14.729637250724354,
          -18.1951353681688,
          7.723365003487771
        ],
        [
          -17.146581805148386,
          -17.066103929053135,
          7.091094616620008
        ],
        [
          -17.710051642913513,
          -16.811068332314953,
          9.525949949941195
        ],
        [
          -16.28884587648575,
          -17.4377078120522,
          6.094794522882661
        ],
        [
          -14.943685861889966,
          -17.979512796364105,
          6.498417217803711
        ],
        [
          -13.371306176722868,
          -18.717230606970077,
          8.101344159499208
        ],
        [
          -17.75450606732583,
          -15.42065540366261,
          9.768863672997398
        ],
        [
          -19.220106384085668,
          -17.31782417699822,
          9.05990581679835
        ],
        [
          -13.182664674019232,
          -20.25715954521068,
          7.9327047731293465
        ],
        [
          -12.16586971907663,
          -17.92263917305541,
          7.390994220036136
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_12",
      "score": 0.1309821758457903,
      "energy": -5.808497523495507,
      "binding_affinity": -6.4844088140607745,
      "ic50": 17636.27036997564,
      "ic50_nm": 17636.27036997564,
      "ligand_efficiency": -0.498800678004675,
      "rmsd": null,
      "confidence": 0.8690178241542097,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2797517612940923,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3110305657386192,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.203071146140932,
          -15.86777020255607,
          8.888752007278592
        ],
        [
          -15.81557121017456,
          -17.131691533430274,
          8.393000843381719
        ],
        [
          -16.514418560434276,
          -17.692368170234477,
          7.206581498492138
        ],
        [
          -14.949770183431493,
          -17.892468031724764,
          9.01599722233388
        ],
        [
          -16.09999147445224,
          -19.02003535617791,
          6.776439192958535
        ],
        [
          -17.561656331166013,
          -16.906299555302883,
          6.507186677557869
        ],
        [
          -15.15735267994678,
          -19.725917912842835,
          7.513996313959779
        ],
        [
          -14.488888866237911,
          -19.172215984332663,
          8.725138550142935
        ],
        [
          -14.246803398341765,
          -17.292355474905722,
          10.336883829714603
        ],
        [
          -16.92252604631725,
          -16.379700961525703,
          5.224167403437327
        ],
        [
          -18.52133951431028,
          -17.80682865542825,
          6.023021245559715
        ],
        [
          -14.794496632005849,
          -17.855444998678802,
          11.607978181008235
        ],
        [
          -12.824113957040666,
          -17.356903162859698,
          10.120857034174675
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_9",
      "score": 0.16565648824347523,
      "energy": -7.299623682870583,
      "binding_affinity": -3.6731423667830296,
      "ic50": 2029042.6965823695,
      "ic50_nm": 2029042.6965823695,
      "ligand_efficiency": -0.28254941282946383,
      "rmsd": null,
      "confidence": 0.8343435117565248,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2786724941787732,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3049132042378488,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.77193456355141,
          -17.7548709132498,
          6.4505399679788304
        ],
        [
          -15.496537632538042,
          -17.63756252768334,
          7.620251375016799
        ],
        [
          -14.855583956350138,
          -17.064906979783736,
          8.745935658696084
        ],
        [
          -16.686303558700057,
          -18.355953331540032,
          7.899101465403514
        ],
        [
          -15.37457116929759,
          -17.06714518335253,
          9.960557230867257
        ],
        [
          -13.507509459976822,
          -16.34614849163867,
          8.480421502583944
        ],
        [
          -16.565551873100382,
          -17.740264467466606,
          10.117952014284748
        ],
        [
          -17.267219169688484,
          -18.368327797696967,
          9.080577778653879
        ],
        [
          -17.361054502830957,
          -19.098089191287233,
          6.771150001026102
        ],
        [
          -13.676494037976058,
          -14.849228793954623,
          8.192943040696026
        ],
        [
          -12.54489395511983,
          -16.665978910424126,
          9.687834747834913
        ],
        [
          -17.16434598300516,
          -20.574680565145027,
          6.81643951052237
        ],
        [
          -18.82800013786507,
          -18.57684284677723,
          6.516295706435528
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_29",
      "score": 0.1829387818669279,
      "energy": -6.1092800271411205,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8170612181330721,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27705645761291087,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3060269289159012,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.410844162790436,
          -18.236916954968756,
          9.95380189212111
        ],
        [
          -15.926763425098663,
          -17.88040725701219,
          8.728561167472826
        ],
        [
          -16.41771400076449,
          -18.328313713642228,
          7.505831620356137
        ],
        [
          -14.83592938844641,
          -17.106632538251134,
          8.641358507923723
        ],
        [
          -16.029755409046167,
          -17.9124829519667,
          6.331957016673645
        ],
        [
          -17.88147290181373,
          -19.104409353906238,
          7.544427340274289
        ],
        [
          -14.887297875378199,
          -17.04953187903755,
          6.165476352055146
        ],
        [
          -14.206069643028737,
          -16.70216414958482,
          7.429438742876055
        ],
        [
          -14.149968367423465,
          -16.62319795781437,
          9.937795068682881
        ],
        [
          -19.01776651233406,
          -18.26039313650642,
          7.466892448465188
        ],
        [
          -17.771062077983167,
          -20.24162004463462,
          6.60642177328582
        ],
        [
          -12.782889243480462,
          -17.441740352283254,
          10.105995233525363
        ],
        [
          -13.782466992412004,
          -15.21218971039174,
          9.92204283628784
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_0",
      "score": 0.18878261658015205,
      "energy": -5.436854186377945,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.811217383419848,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2814291442857093,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3147078669116667,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.175845206313099,
          -16.101315563761286,
          9.273225558566022
        ],
        [
          -15.517940962668703,
          -17.15717956889009,
          8.49493317922517
        ],
        [
          -15.688060062914364,
          -18.485874431089922,
          9.16895901881287
        ],
        [
          -15.66376605475811,
          -17.172717929222273,
          7.017923902915478
        ],
        [
          -16.19825005581562,
          -19.52856989077069,
          8.38669684533814
        ],
        [
          -15.701605771282313,
          -18.523910885021635,
          10.713368305541442
        ],
        [
          -16.369870183722263,
          -19.393105139572555,
          6.966357292160383
        ],
        [
          -15.883339246612138,
          -18.250357022796283,
          6.33129595212145
        ],
        [
          -15.26332938604692,
          -15.869762049709692,
          6.448867266617161
        ],
        [
          -17.042782782592198,
          -18.41942865516025,
          11.312010720237074
        ],
        [
          -15.107836824947618,
          -19.76985806067442,
          10.970525682647686
        ],
        [
          -14.014151844519112,
          -15.922840205290164,
          5.719499815100704
        ],
        [
          -16.47322161780749,
          -15.50508059804072,
          5.536336460716409
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_7",
      "score": 0.1949565499646635,
      "energy": -7.054154483290683,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8050434500353365,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2832122961906459,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3037109643977212,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -13.879999795800213,
          -17.89114407276126,
          7.449423589260885
        ],
        [
          -15.224254225804422,
          -17.86280870578568,
          7.9891835417149935
        ],
        [
          -15.366540387236915,
          -16.80398062403807,
          9.054623750402634
        ],
        [
          -16.175347678770148,
          -18.542731140417178,
          7.410332928503006
        ],
        [
          -16.543385485672818,
          -16.78464795592527,
          9.468459712786295
        ],
        [
          -14.164395675130667,
          -16.130251909929317,
          9.578669007346509
        ],
        [
          -17.73747914995936,
          -17.476655443893108,
          9.05917807886653
        ],
        [
          -17.50412216310005,
          -18.269021526770338,
          7.943813764041813
        ],
        [
          -16.02999912092658,
          -19.40272898463905,
          6.314440579218822
        ],
        [
          -14.065786184086694,
          -14.704711925418557,
          8.99381341835305
        ],
        [
          -14.281082177966583,
          -16.075482303435823,
          11.106040474353044
        ],
        [
          -16.075003877266017,
          -20.976264814888395,
          6.821040022473095
        ],
        [
          -17.052604078279522,
          -19.17957059209795,
          5.15098113267935
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_1",
      "score": 0.22890599747949203,
      "energy": -7.160085005850122,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.771094002520508,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2874133515745195,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3041998914516308,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.312368489956311,
          -15.896488478681338,
          7.449000410411276
        ],
        [
          -15.55532916712788,
          -17.21394096839197,
          7.94715055900468
        ],
        [
          -16.359327137766556,
          -18.03692008418609,
          7.246585423624019
        ],
        [
          -15.123209338749085,
          -17.496668816973784,
          9.251206542718755
        ],
        [
          -16.718793350973964,
          -19.239013247887616,
          7.832045262699882
        ],
        [
          -16.914763587563417,
          -17.731453583314742,
          5.89043701667458
        ],
        [
          -16.204541954203115,
          -19.60852529357466,
          9.033910492932087
        ],
        [
          -15.469756842269339,
          -18.72501704383973,
          9.663149399322528
        ],
        [
          -14.154356779617096,
          -16.606503340934154,
          10.015500134342895
        ],
        [
          -16.071836410151274,
          -18.29435209552833,
          4.7154568631361595
        ],
        [
          -18.400561228313354,
          -18.04173727297513,
          5.799755117165915
        ],
        [
          -14.891329967491693,
          -15.956100286338856,
          11.128915989782476
        ],
        [
          -12.92382574581686,
          -17.253279487373536,
          10.366886788184685
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_16",
      "score": 0.2296596450545303,
      "energy": -6.524438629424791,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7703403549454697,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27369683172131326,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3009047616250171,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.281388924529136,
          -16.01592006293263,
          7.309452611234168
        ],
        [
          -15.63284894370624,
          -17.211609369060735,
          7.931738505503514
        ],
        [
          -14.610955194901345,
          -18.206910799883623,
          8.027397721909303
        ],
        [
          -16.796841031101206,
          -17.317827017855485,
          8.444930104005621
        ],
        [
          -14.968499330508962,
          -19.49534170523819,
          8.507193236836443
        ],
        [
          -13.211267311190984,
          -17.974057979029638,
          7.370702959191444
        ],
        [
          -16.22102932516636,
          -19.609671444967454,
          9.077922349169743
        ],
        [
          -17.145528856242837,
          -18.664650128600492,
          9.006075599009474
        ],
        [
          -17.85228683090625,
          -16.262856128132324,
          8.379673384600537
        ],
        [
          -12.140284285708248,
          -17.60397874901991,
          8.592122725861092
        ],
        [
          -12.777045141341377,
          -19.208141883708954,
          6.583308489100187
        ],
        [
          -18.96744921000945,
          -16.48261483269728,
          7.350193678103544
        ],
        [
          -18.49457561468758,
          -16.04641989887324,
          9.75928863547497
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_5",
      "score": 0.29310478101144877,
      "energy": -6.894560686163294,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7068952189885512,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2701183295826282,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.307299104868762,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.159460305860236,
          -19.204478208161866,
          9.31295797595416
        ],
        [
          -15.944865407207207,
          -18.158816737760688,
          8.49544901220009
        ],
        [
          -16.08064990862877,
          -18.303078943541657,
          7.138438936226116
        ],
        [
          -15.319027263709984,
          -17.048656176977847,
          9.044280828625524
        ],
        [
          -15.770291802461397,
          -17.111796454038934,
          6.355039371217227
        ],
        [
          -16.665272222958457,
          -19.450906178886193,
          6.513531844376406
        ],
        [
          -14.980952243161699,
          -15.952131804952067,
          6.905079524011416
        ],
        [
          -14.860514281603617,
          -15.869658511791911,
          8.278250162019503
        ],
        [
          -14.943690877342814,
          -16.9966031913234,
          10.652851923489415
        ],
        [
          -18.25373565294181,
          -19.204038491163047,
          6.356823783903895
        ],
        [
          -16.058601704369345,
          -19.857829815862754,
          5.260027660805038
        ],
        [
          -13.51188317420679,
          -17.190961442501457,
          10.87662011990561
        ],
        [
          -15.55105515554779,
          -15.751044043038238,
          11.150648857265644
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_8",
      "score": 0.2942668291853444,
      "energy": -6.323736930750637,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7057331708146556,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28065861176372064,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3084420693748227,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.584268488786186,
          -18.29540166744039,
          8.154851723403976
        ],
        [
          -16.267842430179982,
          -17.89149612762163,
          8.07284582288391
        ],
        [
          -15.396477206040625,
          -18.2814532435866,
          7.171721440887463
        ],
        [
          -15.81484536870748,
          -17.140505335108756,
          9.278805160626117
        ],
        [
          -13.980226620980925,
          -17.840973863321643,
          7.203273483733202
        ],
        [
          -15.625154837293804,
          -19.06540443924384,
          6.009003561887507
        ],
        [
          -13.675248617664389,
          -16.985056574641952,
          8.236350882695827
        ],
        [
          -14.544563797961938,
          -16.735306174071617,
          9.280115471187003
        ],
        [
          -16.90544029168061,
          -16.69367022436702,
          10.29043638597717
        ],
        [
          -16.11466815908166,
          -18.404846218203694,
          4.786239649273135
        ],
        [
          -14.738751929158422,
          -20.14935075069561,
          5.836582585173694
        ],
        [
          -16.530970611628867,
          -17.48845928459344,
          11.581072967915226
        ],
        [
          -16.92154164083509,
          -15.128076097103788,
          10.438700864355784
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.27993713231487743,
        "min": 0.2701183295826282,
        "max": 0.2874133515745195,
        "std": 0.005194022622848158
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.3063435806315886,
        "min": -1.3147078669116667,
        "max": -1.3009047616250171,
        "std": 0.003970697747557446
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_4",
        "ml_pose_12",
        "ml_pose_9",
        "ml_pose_29",
        "ml_pose_0",
        "ml_pose_7",
        "ml_pose_1",
        "ml_pose_16",
        "ml_pose_5",
        "ml_pose_8"
      ],
      "total_energy": [
        -7.017850944274077,
        -5.808497523495507,
        -7.299623682870583,
        -6.1092800271411205,
        -5.436854186377945,
        -7.054154483290683,
        -7.160085005850122,
        -6.524438629424791,
        -6.894560686163294,
        -6.323736930750637
      ],
      "vdw": [
        0.2873620449444607,
        0.2797517612940923,
        0.2786724941787732,
        0.27705645761291087,
        0.2814291442857093,
        0.2832122961906459,
        0.2874133515745195,
        0.27369683172131326,
        0.2701183295826282,
        0.28065861176372064
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3022004487938972,
        -1.3110305657386192,
        -1.3049132042378488,
        -1.3060269289159012,
        -1.3147078669116667,
        -1.3037109643977212,
        -1.3041998914516308,
        -1.3009047616250171,
        -1.307299104868762,
        -1.3084420693748227
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -6.876421321522381,
      -6.4844088140607745,
      -3.6731423667830296,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0
    ],
    "ic50_distribution": [
      9099.762289449476,
      17636.27036997564,
      2029042.6965823695,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601
    ],
    "ligand_efficiency_distribution": [
      -0.5289554862709523,
      -0.498800678004675,
      -0.28254941282946383,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 9100.762289449476,
        "delta_g": -6.876421321522381,
        "ligand_efficiency": -0.5289554862709523,
        "lipophilic_efficiency": 2.5409222291914073,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 17637.270369975635,
        "delta_g": -6.4844088140607745,
        "ligand_efficiency": -0.498800678004675,
        "lipophilic_efficiency": 2.253568627536769,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "moderate",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 2029043.6965823693,
        "delta_g": -3.6731423667830296,
        "ligand_efficiency": -0.28254941282946383,
        "lipophilic_efficiency": 0.19270860009319035,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "good",
        "lipe_assessment": "poor",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.531667824823988,
        "length": 7.054236665009038,
        "width": 4.836504141548071,
        "height": 3.9419945084306827
      },
      {
        "radius_of_gyration": 2.5301766668908874,
        "length": 5.697225557269615,
        "width": 3.858147710286765,
        "height": 6.3838107775709085
      },
      {
        "radius_of_gyration": 2.5353830148167598,
        "length": 6.283106182745241,
        "width": 5.725451771190404,
        "height": 3.667412046305918
      },
      {
        "radius_of_gyration": 2.5348604164768354,
        "length": 6.234877268853598,
        "width": 5.029430334242878,
        "height": 3.940518881470217
      },
      {
        "radius_of_gyration": 2.5191642667411704,
        "length": 3.0286309380730856,
        "width": 4.264777462633699,
        "height": 5.775674259520665
      },
      {
        "radius_of_gyration": 2.5404126648270493,
        "length": 3.857479354159146,
        "width": 6.271552889469838,
        "height": 5.955059341673694
      },
      {
        "radius_of_gyration": 2.526319475792009,
        "length": 5.476735482496494,
        "width": 3.712036814893324,
        "height": 6.413459126646316
      },
      {
        "radius_of_gyration": 2.5572908036111723,
        "length": 6.827164924301201,
        "width": 3.5937513820348244,
        "height": 3.1759801463747834
      },
      {
        "radius_of_gyration": 2.546800907160865,
        "length": 4.741852478735019,
        "width": 4.106785772824516,
        "height": 5.8906211964606054
      },
      {
        "radius_of_gyration": 2.5251565599633876,
        "length": 3.9090198711217976,
        "width": 5.0212746535918225,
        "height": 6.794833318642091
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        0.12863353044627823,
        -7.017850944274077
      ],
      [
        0.1309821758457903,
        -5.808497523495507
      ],
      [
        0.16565648824347523,
        -7.299623682870583
      ],
      [
        0.1829387818669279,
        -6.1092800271411205
      ],
      [
        0.18878261658015205,
        -5.436854186377945
      ],
      [
        0.1949565499646635,
        -7.054154483290683
      ],
      [
        0.22890599747949203,
        -7.160085005850122
      ],
      [
        0.2296596450545303,
        -6.524438629424791
      ],
      [
        0.29310478101144877,
        -6.894560686163294
      ],
      [
        0.2942668291853444,
        -6.323736930750637
      ]
    ],
    "score_vs_interactions": [
      [
        0.12863353044627823,
        0
      ],
      [
        0.1309821758457903,
        0
      ],
      [
        0.16565648824347523,
        0
      ],
      [
        0.1829387818669279,
        0
      ],
      [
        0.18878261658015205,
        0
      ],
      [
        0.1949565499646635,
        0
      ],
      [
        0.22890599747949203,
        0
      ],
      [
        0.2296596450545303,
        0
      ],
      [
        0.29310478101144877,
        0
      ],
      [
        0.2942668291853444,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -7.017850944274077,
        0
      ],
      [
        -5.808497523495507,
        0
      ],
      [
        -7.299623682870583,
        0
      ],
      [
        -6.1092800271411205,
        0
      ],
      [
        -5.436854186377945,
        0
      ],
      [
        -7.054154483290683,
        0
      ],
      [
        -7.160085005850122,
        0
      ],
      [
        -6.524438629424791,
        0
      ],
      [
        -6.894560686163294,
        0
      ],
      [
        -6.323736930750637,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -6.876421321522381,
        -0.5289554862709523
      ],
      [
        -6.4844088140607745,
        -0.498800678004675
      ],
      [
        -3.6731423667830296,
        -0.28254941282946383
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        
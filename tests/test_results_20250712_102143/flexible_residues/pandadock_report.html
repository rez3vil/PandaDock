
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDock Docking Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #4CAF50;
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .summary-card h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .summary-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .pose-row {
            cursor: pointer;
        }
        .pose-row.selected {
            background-color: #e8f5e8;
        }
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .interaction-details {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .energy-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .energy-item {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .energy-label {
            font-size: 0.9em;
            color: #666;
        }
        .energy-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-radius: 8px 8px 0 0;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #ddd;
        }
        .tab-content.active {
            display: block;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
        }
        .logo {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pose-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .pose-details.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">PD</div>
                <div>
                    <h1>PandaDock Docking Report</h1>
                    <div class="subtitle">
                        Generated on 2025-07-12T10:23:32.329669 | Version 1.0.0
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Poses</h3>
                    <div class="summary-value" id="total-poses">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Score</h3>
                    <div class="summary-value" id="best-score">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best Binding Affinity</h3>
                    <div class="summary-value" id="best-affinity">-</div>
                </div>
                <div class="summary-card">
                    <h3>Best IC50</h3>
                    <div class="summary-value" id="best-ic50">-</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Detailed Results</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('poses')">Poses</button>
                <button class="tab" onclick="showTab('interactions')">Interactions</button>
                <button class="tab" onclick="showTab('energies')">Energies</button>
                <button class="tab" onclick="showTab('properties')">Properties</button>
            </div>

            <div id="poses-tab" class="tab-content active">
                <div class="table-container">
                    <table id="poses-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Pose ID</th>
                                <th>Score</th>
                                <th>Energy (kcal/mol)</th>
                                <th>Î”G (kcal/mol)</th>
                                <th>IC50 (nM)</th>
                                <th>LE (kcal/mol/atom)</th>
                                <th>Interactions</th>
                                <th>Clash Score</th>
                            </tr>
                        </thead>
                        <tbody id="poses-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="interactions-tab" class="tab-content">
                <div class="interaction-details">
                    <h3>Interaction Statistics</h3>
                    <div id="interaction-stats"></div>
                </div>
            </div>

            <div id="energies-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Energy Breakdown</h3>
                    <div id="energy-chart"></div>
                </div>
            </div>

            <div id="properties-tab" class="tab-content">
                <div class="chart-container">
                    <h3>Molecular Properties</h3>
                    <div id="properties-chart"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PandaDock v1.0.0 | 
               <a href="https://github.com/pandadock/pandadock" target="_blank">GitHub</a> | 
               <a href="https://pandadock.readthedocs.io" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <script>
        // Report data
        const reportData = {
  "metadata": {
    "timestamp": "2025-07-12T10:23:32.329669",
    "pandadock_version": "1.0.0",
    "docking_mode": "balanced",
    "scoring_function": "pandacore",
    "num_poses": 10,
    "flexible_residues": [
      "ASN265"
    ]
  },
  "summary": {
    "total_poses": 10,
    "best_score": 0.10706830097941156,
    "worst_score": 0.24887395979208837,
    "mean_score": 0.18310400058485884,
    "score_range": 0.14180565881267682,
    "best_energy": -8.849794819447002,
    "worst_energy": -5.226627942293779,
    "mean_energy": -6.503546713781418,
    "energy_range": 3.6231668771532233,
    "best_binding_affinity": -8.545907594944147,
    "mean_binding_affinity": -4.1312020299383105,
    "best_ic50": 543.4534115388465,
    "mean_ic50": 4601885.505299732
  },
  "poses": [
    {
      "rank": 1,
      "pose_id": "ml_pose_27",
      "score": 0.10706830097941156,
      "energy": -5.57733092540154,
      "binding_affinity": -8.545907594944147,
      "ic50": 543.4534115388465,
      "ic50_nm": 543.4534115388465,
      "ligand_efficiency": -0.657377507303396,
      "rmsd": null,
      "confidence": 0.8929316990205884,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2678770149046109,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3077803538739747,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.87545944765675,
          -19.50607459084283,
          8.148902847980056
        ],
        [
          -16.119666306661014,
          -18.178465701179135,
          8.114426520173309
        ],
        [
          -15.342800729591467,
          -17.78477950079176,
          9.418803730746292
        ],
        [
          -15.908820140270816,
          -17.406470022584664,
          7.103438120469042
        ],
        [
          -14.693603050600817,
          -16.69431162972158,
          9.392186780252763
        ],
        [
          -15.527975760015494,
          -18.70180818854688,
          10.618742360485411
        ],
        [
          -14.476980886428965,
          -15.890765982928638,
          8.263386579891664
        ],
        [
          -15.144755716508755,
          -16.190825196468886,
          7.089582234800774
        ],
        [
          -16.533876180684167,
          -17.77419562197418,
          5.701322972768665
        ],
        [
          -14.297589826995512,
          -19.55937530989707,
          10.732854375622614
        ],
        [
          -15.838149643210002,
          -17.806669992283084,
          11.762788644441482
        ],
        [
          -17.842503112562778,
          -16.873041799673448,
          5.398809421551517
        ],
        [
          -15.497819198813456,
          -17.733216463107862,
          4.594755410816415
        ]
      ]
    },
    {
      "rank": 2,
      "pose_id": "ml_pose_13",
      "score": 0.11888682817428875,
      "energy": -8.849794819447002,
      "binding_affinity": -8.01296965540037,
      "ic50": 1336.1299450022605,
      "ic50_nm": 1336.1299450022605,
      "ligand_efficiency": -0.6163822811846439,
      "rmsd": null,
      "confidence": 0.8811131718257112,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2799733151681362,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3074927338408258,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.530753108166422,
          -19.083945788528812,
          7.053524963777576
        ],
        [
          -16.031853327583484,
          -18.11570252447207,
          7.812677001087945
        ],
        [
          -14.898687002432442,
          -17.21569636096774,
          7.363028855412516
        ],
        [
          -16.43984149757092,
          -18.038213061808364,
          9.191624548455781
        ],
        [
          -14.304369789069888,
          -16.372751260369338,
          8.157446219875204
        ],
        [
          -14.484505261445008,
          -17.45149494460396,
          5.871056679809744
        ],
        [
          -14.69422596969287,
          -16.207589683585987,
          9.407311077461898
        ],
        [
          -15.81604650446824,
          -17.099981186820287,
          9.915036182112772
        ],
        [
          -17.316079601363388,
          -18.814285079688474,
          9.697175422137903
        ],
        [
          -15.200037689976828,
          -16.399837758494364,
          4.9461943811619875
        ],
        [
          -12.988539523696705,
          -17.451273934633008,
          5.7970316225338685
        ],
        [
          -16.8005915152343,
          -19.897076248513272,
          10.624118570547651
        ],
        [
          -18.59446920929948,
          -17.95215216751431,
          10.503774475625178
        ]
      ]
    },
    {
      "rank": 3,
      "pose_id": "ml_pose_23",
      "score": 0.16567994129943076,
      "energy": -7.832996359426411,
      "binding_affinity": -3.753143049038596,
      "ic50": 1772736.761008571,
      "ic50_nm": 1772736.761008571,
      "ligand_efficiency": -0.2887033114645074,
      "rmsd": null,
      "confidence": 0.8343200587005692,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2720235689971665,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3100245145591667,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.230801923424778,
          -18.707280589613163,
          9.006755165173427
        ],
        [
          -15.17835798999647,
          -18.02892560713215,
          8.477881636514923
        ],
        [
          -16.451275188461754,
          -17.893363781885665,
          9.088703720175438
        ],
        [
          -15.052740904201404,
          -17.39944439568478,
          7.2003146993760225
        ],
        [
          -17.566135101353215,
          -17.193375548107177,
          8.470507003782657
        ],
        [
          -16.73132304314573,
          -18.668103913893656,
          10.428057535196103
        ],
        [
          -17.320786195325674,
          -16.487225992390727,
          7.181741843965749
        ],
        [
          -16.053239642952825,
          -16.579029544406332,
          6.582000607875106
        ],
        [
          -13.734573530107639,
          -17.58371468511884,
          6.4949346142619895
        ],
        [
          -16.661935388479645,
          -17.698381506017444,
          11.510906751746045
        ],
        [
          -18.074460896307443,
          -19.320345751599145,
          10.433878840844269
        ],
        [
          -13.786347965720484,
          -18.42322601485518,
          5.362398956866922
        ],
        [
          -13.258022230522897,
          -16.11758266929573,
          6.101918624221369
        ]
      ]
    },
    {
      "rank": 4,
      "pose_id": "ml_pose_17",
      "score": 0.1804495754934179,
      "energy": -5.516680806601041,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8195504245065821,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.28674275393564547,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3065113974461067,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.28755331439056,
          -15.92986469990489,
          7.569207817754769
        ],
        [
          -15.648551397661663,
          -17.145735785339248,
          7.914719160179187
        ],
        [
          -15.1600650985588,
          -17.526741028800576,
          9.296718303479162
        ],
        [
          -16.18538803254121,
          -18.04478133599233,
          7.163852589430114
        ],
        [
          -15.438563282819935,
          -18.76027752098816,
          9.689995754179181
        ],
        [
          -14.61251151209235,
          -16.51804185616879,
          10.209894379900346
        ],
        [
          -16.114570310703044,
          -19.79173074682231,
          8.78002279333478
        ],
        [
          -16.434450963283048,
          -19.36568922443442,
          7.706395582841306
        ],
        [
          -16.587183762816085,
          -17.68226739088211,
          5.7494320442989455
        ],
        [
          -15.619785090256432,
          -15.898975831857964,
          11.124770841001123
        ],
        [
          -13.469951875756944,
          -17.06125374873232,
          11.000898898572142
        ],
        [
          -15.585869942217712,
          -18.264776914831437,
          4.680651821008697
        ],
        [
          -17.955555416902186,
          -18.109863915245395,
          5.453440014020236
        ]
      ]
    },
    {
      "rank": 5,
      "pose_id": "ml_pose_25",
      "score": 0.18605084080090184,
      "energy": -7.707652745550509,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8139491591990982,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27363752597618773,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.308560284509095,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.377650396592319,
          -18.028620758513085,
          10.206505809360264
        ],
        [
          -15.519825828108658,
          -17.70463560143071,
          8.736070980607758
        ],
        [
          -16.888416459367335,
          -17.41650284063207,
          8.310378085600338
        ],
        [
          -14.539441913225485,
          -18.034323848548937,
          7.837692040428558
        ],
        [
          -17.09217611580962,
          -17.174315629888817,
          6.956332713212379
        ],
        [
          -17.949067501610433,
          -17.081350487480066,
          9.324924999016083
        ],
        [
          -16.16358736035637,
          -17.475540761431475,
          6.069491827569953
        ],
        [
          -14.846931170632566,
          -17.73878794699774,
          6.484481233323654
        ],
        [
          -13.214824631754128,
          -18.507331259329558,
          8.26299864734294
        ],
        [
          -18.026705365488212,
          -15.602602607657218,
          9.645570349091892
        ],
        [
          -19.26024723876719,
          -17.706735959924774,
          8.87022887740729
        ],
        [
          -13.058564457433953,
          -20.011817579698707,
          7.956939423876762
        ],
        [
          -12.162561560853725,
          -17.617434718466846,
          7.678385013162113
        ]
      ]
    },
    {
      "rank": 6,
      "pose_id": "ml_pose_12",
      "score": 0.19652619113785175,
      "energy": -6.888397951333828,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8034738088621483,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2809123434509171,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3055001418225334,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -15.917776088120382,
          -18.89555435451255,
          6.715005293498232
        ],
        [
          -15.812900223731443,
          -18.135757999273537,
          7.675270262062761
        ],
        [
          -16.504055230411314,
          -16.99290376909245,
          7.816759751801492
        ],
        [
          -14.805142700708355,
          -18.312966051251877,
          8.722777325440424
        ],
        [
          -16.470542849338116,
          -16.095745357526777,
          8.91918259956949
        ],
        [
          -17.557454948071936,
          -16.629076075949268,
          6.77339725199123
        ],
        [
          -15.492124638239346,
          -16.30071216696063,
          9.873676080353974
        ],
        [
          -14.650601060222519,
          -17.51564699040615,
          9.74248182779424
        ],
        [
          -13.876117213762804,
          -19.511190250157128,
          8.508154561735019
        ],
        [
          -19.031765549552325,
          -17.05231987197915,
          7.187548042520265
        ],
        [
          -17.525075765099366,
          -15.116156146667922,
          6.355622166568379
        ],
        [
          -12.521615543510281,
          -19.191603038045,
          8.199738211254461
        ],
        [
          -13.934828189231785,
          -20.350367928177498,
          9.850386625410025
        ]
      ]
    },
    {
      "rank": 7,
      "pose_id": "ml_pose_15",
      "score": 0.19662195921436632,
      "energy": -5.710886122601665,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.8033780407856337,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.27598246455754694,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3039953433480487,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -13.725787618630129,
          -17.941693453868954,
          8.352849686268865
        ],
        [
          -15.081638466796765,
          -17.694224027790984,
          8.244676600072452
        ],
        [
          -15.945604465793963,
          -18.586651987678206,
          8.917917912061355
        ],
        [
          -15.62057630746516,
          -16.786011454825584,
          7.395012440349564
        ],
        [
          -17.402856595730384,
          -18.45727151379069,
          8.905070699235832
        ],
        [
          -15.36132162474276,
          -19.715445322889913,
          9.795381695289716
        ],
        [
          -17.813672093984152,
          -17.502002562952594,
          7.987959672865159
        ],
        [
          -16.988745797706994,
          -16.67797845696444,
          7.3123670810949335
        ],
        [
          -14.748598903286059,
          -15.917628984789243,
          6.525038563537972
        ],
        [
          -15.360050600298614,
          -19.22059324288431,
          11.24392346183284
        ],
        [
          -16.038561477775247,
          -21.076991542234328,
          9.700443389737373
        ],
        [
          -14.799731480505478,
          -16.202562033834546,
          5.135707535433749
        ],
        [
          -15.21285456728424,
          -14.320945415496166,
          6.823651262220203
        ]
      ]
    },
    {
      "rank": 8,
      "pose_id": "ml_pose_11",
      "score": 0.20908195884895742,
      "energy": -5.226627942293779,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7909180411510426,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2832286773243823,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3121393117143962,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -16.47295008424784,
          -18.52127165756185,
          9.797648331777632
        ],
        [
          -15.937857323733354,
          -17.923217790170163,
          8.729050411022936
        ],
        [
          -16.18588230157846,
          -16.538061755237088,
          8.473003446360162
        ],
        [
          -15.175174506876704,
          -18.77449702016513,
          7.774160068383409
        ],
        [
          -15.622111554543988,
          -16.102937446306562,
          7.222337874734514
        ],
        [
          -17.001538062701826,
          -15.689323798842729,
          9.314891089908011
        ],
        [
          -14.880982928730107,
          -16.80038620596255,
          6.369231586850963
        ],
        [
          -14.688358389530041,
          -18.201783338358656,
          6.639512236590722
        ],
        [
          -14.921908576557557,
          -20.13081720568395,
          8.015946892423182
        ],
        [
          -16.13117926481989,
          -14.979263773502737,
          10.189696154117923
        ],
        [
          -17.917026476583523,
          -14.891642608467304,
          8.487731592375756
        ],
        [
          -15.74122901825223,
          -21.063342825102456,
          7.268325669724689
        ],
        [
          -13.423801511844474,
          -20.48345457463881,
          8.058464645730105
        ]
      ]
    },
    {
      "rank": 9,
      "pose_id": "ml_pose_20",
      "score": 0.22180045010787375,
      "energy": -6.092292253463451,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7781995498921263,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.29171352590968186,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3018393545711646,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -14.123792776673078,
          -16.61558675809367,
          8.058511275768419
        ],
        [
          -15.216704104051544,
          -17.383880201189264,
          8.231484263102237
        ],
        [
          -16.01459744021783,
          -17.540348203693746,
          7.142547843687311
        ],
        [
          -15.574885503404023,
          -17.972118079991354,
          9.311153906156358
        ],
        [
          -17.213241054227026,
          -18.187885855510476,
          7.121172655121134
        ],
        [
          -15.654311171633008,
          -16.68373243075266,
          5.782164471400421
        ],
        [
          -17.524334491476875,
          -18.918953158029446,
          8.26411018832919
        ],
        [
          -16.67757630188672,
          -18.75916350192291,
          9.286675088193169
        ],
        [
          -14.659164981498844,
          -17.936966914507263,
          10.538020809828131
        ],
        [
          -15.060027005255396,
          -17.64695385253629,
          4.75676295446055
        ],
        [
          -16.94337278921449,
          -15.954062834357003,
          5.2397732802262755
        ],
        [
          -15.230901997677393,
          -17.113355731516737,
          11.586706115236654
        ],
        [
          -14.207090382783772,
          -19.3869924778992,
          11.020917148490147
        ]
      ]
    },
    {
      "rank": 10,
      "pose_id": "ml_pose_7",
      "score": 0.24887395979208837,
      "energy": -5.632807211694948,
      "binding_affinity": -3.0,
      "ic50": 6320605.529804601,
      "ic50_nm": 6320605.529804601,
      "ligand_efficiency": -0.23076923076923078,
      "rmsd": null,
      "confidence": 0.7511260402079116,
      "clash_score": 0.0,
      "binding_site_coverage": 0.0,
      "energy_breakdown": {
        "vdw": 0.2758151096396614,
        "electrostatic": 0.0,
        "hbond": -6.0,
        "hydrophobic": -4.0,
        "solvation": -1.3044207400913899,
        "entropy": 2.2
      },
      "interactions": {
        "hbonds": 0,
        "hydrophobic": 0,
        "salt_bridges": 0
      },
      "flexible_residues": [],
      "coordinates": [
        [
          -17.342048831023334,
          -17.39127101647722,
          9.23863290510026
        ],
        [
          -16.19262204857265,
          -17.603602368284285,
          8.40185849405768
        ],
        [
          -15.90214771117136,
          -16.831685857249955,
          7.40681198771124
        ],
        [
          -15.3159395263464,
          -18.676954260726106,
          8.829040252557345
        ],
        [
          -14.824295130847789,
          -16.93599949056029,
          6.637317839469116
        ],
        [
          -16.85800790637284,
          -15.606178388448281,
          7.058084244915516
        ],
        [
          -13.927019808932762,
          -18.023265816970383,
          6.955132471177876
        ],
        [
          -14.203340635871943,
          -18.9914788276531,
          8.067530228234197
        ],
        [
          -15.677843118468598,
          -19.55034867922315,
          10.0921428456267
        ],
        [
          -16.343061463851583,
          -14.336210776979978,
          7.602128147510857
        ],
        [
          -17.07271568262323,
          -15.602555223120788,
          5.547512236524772
        ],
        [
          -16.087179570590045,
          -20.87116906163158,
          9.545787032863267
        ],
        [
          -14.35377856532747,
          -19.679280232674955,
          10.958021314251102
        ]
      ]
    }
  ],
  "interactions": {
    "hbond_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "hydrophobic_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "salt_bridge_stats": {
      "total": 0,
      "average": 0.0,
      "max": 0,
      "min": 0
    },
    "interaction_frequency": {},
    "best_interactions": {
      "hbonds": [],
      "hydrophobic": [],
      "salt_bridges": []
    }
  },
  "energy_analysis": {
    "energy_contributions": {
      "vdw_energy": {
        "average": 0.2787906299863936,
        "min": 0.2678770149046109,
        "max": 0.29171352590968186,
        "std": 0.00681196223361601
      },
      "electrostatic_energy": {
        "average": 0.0,
        "min": 0.0,
        "max": 0.0,
        "std": 0.0
      },
      "hbond_energy": {
        "average": -6.0,
        "min": -6.0,
        "max": -6.0,
        "std": 0.0
      },
      "hydrophobic_energy": {
        "average": -4.0,
        "min": -4.0,
        "max": -4.0,
        "std": 0.0
      },
      "solvation_energy": {
        "average": -1.30682641757767,
        "min": -1.3121393117143962,
        "max": -1.3018393545711646,
        "std": 0.002886974934449371
      },
      "entropy_energy": {
        "average": 2.2,
        "min": 2.2,
        "max": 2.2,
        "std": 0.0
      }
    },
    "energy_correlations": {},
    "energy_distribution": {
      "poses": [
        "ml_pose_27",
        "ml_pose_13",
        "ml_pose_23",
        "ml_pose_17",
        "ml_pose_25",
        "ml_pose_12",
        "ml_pose_15",
        "ml_pose_11",
        "ml_pose_20",
        "ml_pose_7"
      ],
      "total_energy": [
        -5.57733092540154,
        -8.849794819447002,
        -7.832996359426411,
        -5.516680806601041,
        -7.707652745550509,
        -6.888397951333828,
        -5.710886122601665,
        -5.226627942293779,
        -6.092292253463451,
        -5.632807211694948
      ],
      "vdw": [
        0.2678770149046109,
        0.2799733151681362,
        0.2720235689971665,
        0.28674275393564547,
        0.27363752597618773,
        0.2809123434509171,
        0.27598246455754694,
        0.2832286773243823,
        0.29171352590968186,
        0.2758151096396614
      ],
      "electrostatic": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "hbond": [
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0,
        -6.0
      ],
      "hydrophobic": [
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0,
        -4.0
      ],
      "solvation": [
        -1.3077803538739747,
        -1.3074927338408258,
        -1.3100245145591667,
        -1.3065113974461067,
        -1.308560284509095,
        -1.3055001418225334,
        -1.3039953433480487,
        -1.3121393117143962,
        -1.3018393545711646,
        -1.3044207400913899
      ],
      "entropy": [
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2,
        2.2
      ]
    }
  },
  "binding_analysis": {
    "affinity_distribution": [
      -8.545907594944147,
      -8.01296965540037,
      -3.753143049038596,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0,
      -3.0
    ],
    "ic50_distribution": [
      543.4534115388465,
      1336.1299450022605,
      1772736.761008571,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601,
      6320605.529804601
    ],
    "ligand_efficiency_distribution": [
      -0.657377507303396,
      -0.6163822811846439,
      -0.2887033114645074,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078,
      -0.23076923076923078
    ],
    "drug_likeness_assessment": [
      {
        "ic50": 544.4534115388464,
        "delta_g": -8.545907594944147,
        "ligand_efficiency": -0.657377507303396,
        "lipophilic_efficiency": 3.7640392765642954,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 8,
        "max_score": 10,
        "drug_likeness_category": "excellent"
      },
      {
        "ic50": 1337.1299450022605,
        "delta_g": -8.01296965540037,
        "ligand_efficiency": -0.6163822811846439,
        "lipophilic_efficiency": 3.373826385067755,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "excellent",
        "lipe_assessment": "good",
        "drug_likeness_score": 6,
        "max_score": 10,
        "drug_likeness_category": "good"
      },
      {
        "ic50": 1772737.761008571,
        "delta_g": -3.753143049038596,
        "ligand_efficiency": -0.2887033114645074,
        "lipophilic_efficiency": 0.25135550431460985,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "good",
        "lipe_assessment": "poor",
        "drug_likeness_score": 4,
        "max_score": 10,
        "drug_likeness_category": "moderate"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      },
      {
        "ic50": 6320606.5298046,
        "delta_g": -3.0,
        "ligand_efficiency": -0.23076923076923078,
        "lipophilic_efficiency": -0.3007587554830522,
        "lipinski_violations": 0,
        "lipinski_compliant": true,
        "veber_compliant": false,
        "tpsa_estimate": 120,
        "le_assessment": "moderate",
        "lipe_assessment": "poor",
        "drug_likeness_score": 2,
        "max_score": 10,
        "drug_likeness_category": "poor"
      }
    ]
  },
  "molecular_properties": {
    "size_distribution": [
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13,
      13
    ],
    "flexibility_distribution": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "shape_descriptors": [
      {
        "radius_of_gyration": 2.5509450625758103,
        "length": 3.544913285567265,
        "width": 3.668609326968433,
        "height": 7.168033233625067
      },
      {
        "radius_of_gyration": 2.5378651393132223,
        "length": 5.605929685602774,
        "width": 3.689486564927286,
        "height": 5.677924189385664
      },
      {
        "radius_of_gyration": 2.54375720715654,
        "length": 4.8164386657845455,
        "width": 3.2027630823034166,
        "height": 6.148507794879123
      },
      {
        "radius_of_gyration": 2.5245439379176764,
        "length": 4.485603541145242,
        "width": 3.892754914964346,
        "height": 6.444119019992426
      },
      {
        "radius_of_gyration": 2.5362545866414483,
        "length": 7.097685677913464,
        "width": 4.4092149720414895,
        "height": 4.137013981790311
      },
      {
        "radius_of_gyration": 2.5325371568401858,
        "length": 6.5101500060420445,
        "width": 5.2342117815095754,
        "height": 3.518053913785595
      },
      {
        "radius_of_gyration": 2.546347497128967,
        "length": 4.0878844753540236,
        "width": 6.756046126738163,
        "height": 6.10821592639909
      },
      {
        "radius_of_gyration": 2.5210310069976085,
        "length": 4.493224964739049,
        "width": 6.171700216635152,
        "height": 3.820464567266961
      },
      {
        "radius_of_gyration": 2.5195150514870592,
        "length": 3.400541714803797,
        "width": 3.432929643542195,
        "height": 6.829943160776104
      },
      {
        "radius_of_gyration": 2.547819199862573,
        "length": 3.4150290220905717,
        "width": 6.5349582846516014,
        "height": 5.41050907772633
      }
    ]
  },
  "comparison_data": {
    "score_vs_energy": [
      [
        0.10706830097941156,
        -5.57733092540154
      ],
      [
        0.11888682817428875,
        -8.849794819447002
      ],
      [
        0.16567994129943076,
        -7.832996359426411
      ],
      [
        0.1804495754934179,
        -5.516680806601041
      ],
      [
        0.18605084080090184,
        -7.707652745550509
      ],
      [
        0.19652619113785175,
        -6.888397951333828
      ],
      [
        0.19662195921436632,
        -5.710886122601665
      ],
      [
        0.20908195884895742,
        -5.226627942293779
      ],
      [
        0.22180045010787375,
        -6.092292253463451
      ],
      [
        0.24887395979208837,
        -5.632807211694948
      ]
    ],
    "score_vs_interactions": [
      [
        0.10706830097941156,
        0
      ],
      [
        0.11888682817428875,
        0
      ],
      [
        0.16567994129943076,
        0
      ],
      [
        0.1804495754934179,
        0
      ],
      [
        0.18605084080090184,
        0
      ],
      [
        0.19652619113785175,
        0
      ],
      [
        0.19662195921436632,
        0
      ],
      [
        0.20908195884895742,
        0
      ],
      [
        0.22180045010787375,
        0
      ],
      [
        0.24887395979208837,
        0
      ]
    ],
    "energy_vs_interactions": [
      [
        -5.57733092540154,
        0
      ],
      [
        -8.849794819447002,
        0
      ],
      [
        -7.832996359426411,
        0
      ],
      [
        -5.516680806601041,
        0
      ],
      [
        -7.707652745550509,
        0
      ],
      [
        -6.888397951333828,
        0
      ],
      [
        -5.710886122601665,
        0
      ],
      [
        -5.226627942293779,
        0
      ],
      [
        -6.092292253463451,
        0
      ],
      [
        -5.632807211694948,
        0
      ]
    ],
    "affinity_vs_efficiency": [
      [
        -8.545907594944147,
        -0.657377507303396
      ],
      [
        -8.01296965540037,
        -0.6163822811846439
      ],
      [
        -3.753143049038596,
        -0.2887033114645074
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ],
      [
        -3.0,
        -0.23076923076923078
      ]
    ]
  }
};
        
        // Initialize report
        document.addEventListener('DOMContentLoaded', function() {
            initializeReport();
        });
        
        function initializeReport() {
            updateSummary();
            populatePosesTable();
            updateInteractionStats();
            updateEnergyChart();
            updatePropertiesChart();
        }
        
        function updateSummary() {
            const summary = reportData.summary;
            
            document.getElementById('total-poses').textContent = summary.total_poses || '-';
            document.getElementById('best-score').textContent = (summary.best_score || 0).toFixed(3);
            document.getElementById('best-affinity').textContent = (summary.best_binding_affinity || 0).toFixed(2) + ' kcal/mol';
            
            const bestIC50 = summary.best_ic50;
            if (bestIC50 && bestIC50 !== Infinity) {
                document.getElementById('best-ic50').textContent = bestIC50.toFixed(1) + ' nM';
            } else {
                document.getElementById('best-ic50').textContent = '-';
            }
        }
        
        function populatePosesTable() {
            const tbody = document.getElementById('poses-tbody');
            tbody.innerHTML = '';
            
            reportData.poses.forEach((pose, index) => {
                const row = document.createElement('tr');
                row.className = 'pose-row';
                row.onclick = () => showPoseDetails(index);
                
                const totalInteractions = pose.interactions.hbonds + 
                                        pose.interactions.hydrophobic + 
                                        pose.interactions.salt_bridges;
                
                row.innerHTML = `
                    <td>${pose.rank}</td>
                    <td>${pose.pose_id}</td>
                    <td>${pose.score.toFixed(3)}</td>
                    <td>${pose.energy.toFixed(2)}</td>
                    <td>${pose.binding_affinity.toFixed(2)}</td>
                    <td>${pose.ic50_nm === Infinity ? '-' : pose.ic50_nm.toFixed(1)}</td>
                    <td>${pose.ligand_efficiency.toFixed(3)}</td>
                    <td>${totalInteractions}</td>
                    <td>${pose.clash_score.toFixed(2)}</td>
                `;
                
                tbody.appendChild(row);
                
                // Add details row
                const detailRow = document.createElement('tr');
                detailRow.innerHTML = `
                    <td colspan="9">
                        <div class="pose-details" id="pose-details-${index}">
                            <h4>Energy Breakdown</h4>
                            <div class="energy-breakdown">
                                <div class="energy-item">
                                    <div class="energy-label">van der Waals</div>
                                    <div class="energy-value">${pose.energy_breakdown.vdw.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Electrostatic</div>
                                    <div class="energy-value">${pose.energy_breakdown.electrostatic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">H-bonds</div>
                                    <div class="energy-value">${pose.energy_breakdown.hbond.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Hydrophobic</div>
                                    <div class="energy-value">${pose.energy_breakdown.hydrophobic.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Solvation</div>
                                    <div class="energy-value">${pose.energy_breakdown.solvation.toFixed(2)}</div>
                                </div>
                                <div class="energy-item">
                                    <div class="energy-label">Entropy</div>
                                    <div class="energy-value">${pose.energy_breakdown.entropy.toFixed(2)}</div>
                                </div>
                            </div>
                            <h4>Interactions</h4>
                            <p>Hydrogen bonds: ${pose.interactions.hbonds} | 
                               Hydrophobic contacts: ${pose.interactions.hydrophobic} | 
                               Salt bridges: ${pose.interactions.salt_bridges}</p>
                            ${pose.flexible_residues.length > 0 ? 
                              `<h4>Flexible Residues</h4><p>${pose.flexible_residues.join(', ')}</p>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(detailRow);
            });
        }
        
        function showPoseDetails(index) {
            // Hide all details
            document.querySelectorAll('.pose-details').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // Remove selection from all rows
            document.querySelectorAll('.pose-row').forEach(row => {
                row.classList.remove('selected');
            });
            
            // Show selected details
            const detail = document.getElementById(`pose-details-${index}`);
            const row = document.querySelectorAll('.pose-row')[index];
            
            if (detail.classList.contains('active')) {
                detail.classList.remove('active');
                row.classList.remove('selected');
            } else {
                detail.classList.add('active');
                row.classList.add('selected');
            }
        }
        
        function updateInteractionStats() {
            const interactions = reportData.interactions;
            const statsDiv = document.getElementById('interaction-stats');
            
            statsDiv.innerHTML = `
                <div class="energy-breakdown">
                    <div class="energy-item">
                        <div class="energy-label">Hydrogen Bonds</div>
                        <div class="energy-value">Avg: ${interactions.hbond_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hbond_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Hydrophobic</div>
                        <div class="energy-value">Avg: ${interactions.hydrophobic_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.hydrophobic_stats.max}</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Salt Bridges</div>
                        <div class="energy-value">Avg: ${interactions.salt_bridge_stats.average.toFixed(1)}</div>
                        <div class="energy-label">Max: ${interactions.salt_bridge_stats.max}</div>
                    </div>
                </div>
            `;
        }
        
        function updateEnergyChart() {
            const energyDiv = document.getElementById('energy-chart');
            const energyDist = reportData.energy_analysis.energy_distribution;
            const energyContrib = reportData.energy_analysis.energy_contributions;
            
            if (energyDist.poses && energyDist.poses.length > 0) {
                let html = '<div class="energy-analysis">';
                
                // Energy contributions overview
                html += '<h4>Average Energy Contributions</h4>';
                html += '<div class="energy-breakdown">';
                
                Object.keys(energyContrib).forEach(component => {
                    const data = energyContrib[component];
                    const color = component.includes('hbond') || component.includes('hydrophobic') || component.includes('solvation') ? '#4CAF50' : 
                                 component.includes('vdw') || component.includes('entropy') ? '#f44336' : '#2196F3';
                    
                    html += `
                        <div class="energy-item" style="border-left: 4px solid ${color}">
                            <div class="energy-label">${component.replace('_', ' ').toUpperCase()}</div>
                            <div class="energy-value">${data.average.toFixed(2)}</div>
                            <div class="energy-label">Range: ${data.min.toFixed(2)} to ${data.max.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Energy distribution table
                html += '<h4>Energy Distribution Across Poses</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>Total</th><th>vdW</th><th>H-bonds</th><th>Hydrophobic</th><th>Solvation</th><th>Entropy</th></tr></thead>';
                html += '<tbody>';
                
                energyDist.poses.forEach((pose, i) => {
                    html += `<tr>
                        <td>${pose}</td>
                        <td>${energyDist.total_energy[i].toFixed(2)}</td>
                        <td>${energyDist.vdw[i].toFixed(2)}</td>
                        <td>${energyDist.hbond[i].toFixed(2)}</td>
                        <td>${energyDist.hydrophobic[i].toFixed(2)}</td>
                        <td>${energyDist.solvation[i].toFixed(2)}</td>
                        <td>${energyDist.entropy[i].toFixed(2)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div></div>';
                energyDiv.innerHTML = html;
            } else {
                energyDiv.innerHTML = '<p>No energy data available</p>';
            }
        }
        
        function updatePropertiesChart() {
            const propertiesDiv = document.getElementById('properties-chart');
            const molecular = reportData.molecular_properties;
            const binding = reportData.binding_analysis;
            
            let html = '<div class="properties-analysis">';
            
            // Molecular size and flexibility
            html += '<h4>Molecular Properties Overview</h4>';
            html += '<div class="energy-breakdown">';
            
            if (molecular.size_distribution && molecular.size_distribution.length > 0) {
                const avgSize = molecular.size_distribution.reduce((a, b) => a + b, 0) / molecular.size_distribution.length;
                const avgFlex = molecular.flexibility_distribution.reduce((a, b) => a + b, 0) / molecular.flexibility_distribution.length;
                
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Average Molecular Size</div>
                        <div class="energy-value">${avgSize.toFixed(0)} atoms</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Average Flexibility</div>
                        <div class="energy-value">${avgFlex.toFixed(1)} bonds</div>
                    </div>
                `;
            }
            
            // Shape descriptors
            if (molecular.shape_descriptors && molecular.shape_descriptors.length > 0) {
                const avgShape = molecular.shape_descriptors[0];
                html += `
                    <div class="energy-item">
                        <div class="energy-label">Radius of Gyration</div>
                        <div class="energy-value">${avgShape.radius_of_gyration.toFixed(2)} Ã…</div>
                    </div>
                    <div class="energy-item">
                        <div class="energy-label">Molecular Dimensions</div>
                        <div class="energy-value">${avgShape.length.toFixed(1)} Ã— ${avgShape.width.toFixed(1)} Ã— ${avgShape.height.toFixed(1)} Ã…</div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Drug-likeness assessment
            if (binding.drug_likeness_assessment && binding.drug_likeness_assessment.length > 0) {
                html += '<h4>Drug-likeness Assessment</h4>';
                html += '<div class="table-container">';
                html += '<table>';
                html += '<thead><tr><th>Pose</th><th>LE</th><th>Lipinski</th><th>Veber</th><th>TPSA</th><th>Category</th></tr></thead>';
                html += '<tbody>';
                
                binding.drug_likeness_assessment.forEach((assessment, i) => {
                    const pose = reportData.poses[i];
                    html += `<tr>
                        <td>${pose.pose_id}</td>
                        <td>${assessment.ligand_efficiency.toFixed(3)}</td>
                        <td>${assessment.lipinski_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.veber_compliant ? 'Pass' : 'Fail'}</td>
                        <td>${assessment.tpsa_estimate}</td>
                        <td style="color: ${assessment.drug_likeness_category === 'good' ? 'green' : 
                                              assessment.drug_likeness_category === 'moderate' ? 'orange' : 'red'}">
                            ${assessment.drug_likeness_category}
                        </td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
            }
            
            html += '</div>';
            propertiesDiv.innerHTML = html;
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
        